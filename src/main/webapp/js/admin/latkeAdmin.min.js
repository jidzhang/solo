function getUUID(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?a:3&a|8).toString(16)});return t=t.replace(new RegExp("-","g"),"")}var Admin=function(){this.register={},this.tools=["#page-list","#file-list","#link-list","#preference","#user-list","#plugin-list","#others","#category-list"],this.adTools=["link-list","preference","file-list","page-list","user-list","plugin-list","others","category-list"]};$.extend(Admin.prototype,{logout:function(){window.location.href=latkeConfig.servePath+"/logout?goto="+latkeConfig.servePath},toggleMenu:function(){"-240px"===$("#tabs").css("left")?($("#tabs").css("left",0),$(".tabs__bg").show()):($("#tabs").css("left","-240px"),$(".tabs__bg").hide())},clearTip:function(){$("#tipMsg").text(""),$("#loadMsg").text("")},setHashByPage:function(e){var t=window.location.hash,a=t.split("/");/^\d*$/.test(a[a.length-1])?a[a.length-1]=e:a.push(e),window.location.hash=a.join("/")},selectTab:function(e){window.location.hash="#"+e},analyseHash:function(){var e=window.location.hash,t=e.substr(1,e.length-1),a=t.split("/"),i={};i.page=1,i.hashList=[];for(var n=0;n<a.length;n++)n===a.length-1&&/^\d+$/.test(a[n])?i.page=a[n]:i.hashList.push(a[n]);return i},setCurByHash:function(){$(window).scrollTop(0),$("#tipMsg").text("");var e=admin.analyseHash(),t=e.hashList[1],a=e.hashList[2];if(1===e.hashList.length&&(t=e.hashList[0]),""!==t){"article"!==t?admin.article.clearDraftTimer():"article"===t&&(admin.article.autoSaveDraftTimer=setInterval(function(){admin.article._autoSaveToDraft()},admin.article.AUTOSAVETIME));try{if("article"!==t&&admin.article.isConfirm&&""!==admin.editors.articleEditor.getContent().replace(/\s/g,"")&&admin.article.content!==admin.editors.articleEditor.getContent()&&!confirm(Label.editorLeaveLabel))return void(window.location.hash="#article/article");if("article"===t&&admin.article.isConfirm&&""!==admin.editors.articleEditor.getContent().replace(/\s/g,"")&&admin.article.content!==admin.editors.articleEditor.getContent())return}catch(e){var i=$("#articleContent");if(i.length>0){if("article"!==t&&admin.article.isConfirm&&""!==i.val().replace(/\s/g,"")&&admin.article.content!==i.val()&&!confirm(Label.editorLeaveLabel))return void(window.location.hash="#article/article");if("article"===t&&admin.article.isConfirm&&""!==i.val().replace(/\s/g,"")&&admin.article.content!==i.val())return}}"article"!==t&&admin.editors.articleEditor.setContent&&admin.article.clear(),admin.article.isConfirm=!0,$("#tabs").tabs("setCurrent",t),$("#loadMsg").text(Label.loadingLabel),1===$("#tabsPanel_"+t).length?""===$("#tabsPanel_"+t).html().replace(/\s/g,"")?$("#tabsPanel_"+t).load("admin-"+t+".do",function(){"article"===t&&admin.article.status.id?admin.register[t].init.call(admin.register[t].obj,admin.article.getAndSet):admin.register[t].init.call(admin.register[t].obj,e.page),a&&$("#tab"+t.substring(0,1).toUpperCase()+t.substring(1)).tabs("setCurrent",a),admin.plugin.setCurByHash(e)}):("article"===t&&admin.article.status.id&&admin.article.getAndSet(),admin.register[t]&&admin.register[t].refresh&&admin.register[t].refresh.call(admin.register[t].obj,e.page),a&&$("#tab"+t.substring(0,1).toUpperCase()+t.substring(1)).tabs("setCurrent",a),admin.plugin.setCurByHash(e)):($("#tipMsg").text("Error: No tab! "+Label.reportIssueLabel),$("#loadMsg").text(""))}},init:function(){Util.killIE(),$("#loadMsg").text(Label.loadingLabel),$("#tabs").tabs(),setInterval(function(){""!==$("#tipMsg").text()&&setTimeout(function(){$("#tipMsg").text("")},7e3)},6e3),$("#loadMsg").text("")},collapseNav:function(e){$(e).next().slideToggle("normal",function(){"none"!==this.style.display?($(e).find(".icon-chevron-down")[0].className="icon-chevron-up right",$(e).addClass("tab-current")):($(e).find(".icon-chevron-up")[0].className="icon-chevron-down right",$(e).removeClass("tab-current")),$("#tabs > ul").height("auto"),$("#tabs > ul").height($("#tabs > ul").height()+80)})},inited:function(){if("adminRole"!==Label.userRole)for(var e=0;e<this.adTools.length;e++)$("#tabs").tabs("remove",this.adTools[e]);else for(var t=0;t<this.tools.length;t++)if("#"+window.location.hash.split("/")[1]===this.tools[t]){$("#tabToolsTitle").click();break}this.setCurByHash()}});var admin=new Admin;admin.editors={};var SoloEditor=function(e){this._defaults={type:"tinyMCE",kind:"",id:"",language:""},e.type=Label.editorType,this.conf=e,this._init()};$.extend(SoloEditor.prototype,{_init:function(){this.init()},init:function(e){var t=this.conf;e&&(t.type=e);var a=t.type.split("-");2===a.length&&(t.codeMirrorLanguage=a[1],t.type=a[0]),admin.editors[t.type].init(t)},getContent:function(){var e=this.conf;return admin.editors[e.type].getContent(e.id)},setContent:function(e){var t=this.conf;admin.editors[t.type].setContent(t.id,e)},remove:function(){var e=this.conf;admin.editors[e.type].remove(e.id)}}),admin.editors.articleEditor={},admin.editors.abstractEditor={},admin.editors.pageEditor={},admin.editors.tinyMCE={init:function(e){var t=Label.localeString.substring(0,2);if("zh"===t&&(t="zh-cn"),e.kind&&"simple"===e.kind)try{tinyMCE.init({language:t,mode:"exact",elements:e.id,theme:"advanced",plugins:"media",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,undo,redo,|,bullist,numlist,|,code",theme_advanced_buttons2:"",theme_advanced_buttons3:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",valid_children:"+body[style]"})}catch(e){$("#tipMsg").text("TinyMCE load fail")}else try{tinyMCE.init({language:t,mode:"exact",elements:e.id,theme:"advanced",plugins:"autosave,style,advhr,advimage,advlink,preview,inlinepopups,media,paste,syntaxhl,wordcount",theme_advanced_buttons1:"formatselect,fontselect,fontsizeselect,|,bold,italic,underline,strikethrough,forecolor,|,advhr,blockquote,syntaxhl,",theme_advanced_buttons2:"undo,redo,|,bullist,numlist,outdent,indent,|,justifyleft,justifycenter,justifyright,justifyfull,|,pastetext,pasteword,|,link,unlink,image,iespell,media,|,cleanup,code,preview,",theme_advanced_buttons3:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_resizing:!0,theme_advanced_statusbar_location:"bottom",extended_valid_elements:"link[type|rel|href|charset],pre[name|class],iframe[src|width|height|name|align],+a[*]",valid_children:"+body[style]",relative_urls:!1,remove_script_host:!1,oninit:function(){"function"==typeof e.fun&&e.fun()}})}catch(e){$("#tipMsg").text("TinyMCE load fail")}},getContent:function(e){var t="";try{t=tinyMCE.get(e).getContent()}catch(a){t=$("#"+e).val()}return t},setContent:function(e,t){try{tinyMCE.get(e)?tinyMCE.get(e).setContent(t):$("#"+e).val(t)}catch(a){$("#"+e).val(t)}},remove:function(e){tinyMCE.get(e).remove()}},admin.editors.KindEditor={init:function(e){var t="zh_CN";if("en_US"===Label.localeString&&(t="en"),e.kind&&"simple"===e.kind)try{this[e.id]=KindEditor.create("#"+e.id,{langType:t,resizeType:0,items:["bold","italic","underline","strikethrough","|","undo","redo","|","insertunorderedlist","insertorderedlist","|","source"]})}catch(e){$("#tipMsg").text("KindEditor load fail")}else try{this[e.id]=KindEditor.create("#"+e.id,{uploadJson:"kindeditor/php/upyunUpload.php",langType:t,items:["formatblock","fontname","fontsize","|","bold","italic","underline","strikethrough","forecolor","|","link","unlink","image","media","|","pagebreak","emoticons","code","/","undo","redo","|","insertunorderedlist","insertorderedlist","indent","outdent","|","justifyleft","justifycenter","justifyright","justifyfull","|","plainpaste","wordpaste","|","clearhtml","source","preview"],afterCreate:function(){"function"==typeof e.fun&&e.fun()}})}catch(e){$("#tipMsg").text("KindEditor load fail")}},getContent:function(e){var t="";try{t=this[e].html()}catch(a){t=$("#"+e).val()}return t},setContent:function(e,t){try{this[e].html(t)}catch(a){$("#"+e).val(t)}},remove:function(e){this[e].remove()}},Util.processClipBoard=function(e,t){var e=toMarkdown(e,{converters:[],gfm:!0});return e=$("<div>"+e+"</div>").text().replace(/\n{2,}/g,"\n\n").replace(/ /g," "),$.trim(e)},Util.startsWith=function(e,t){return e.match("^"+t)==t},Util.processClipBoard=function(e,t){if(""===e.getData("text/html")&&2===e.items.length)return"";var a=toMarkdown(e.getData("text/html"),{converters:[{filter:"img",replacement:function(e,t){return 1===t.attributes.length?"":"![]("+t.src+")"}}],gfm:!0}),i=a.split("```");if(i.length>1)for(var n=0,l=i.length;n<l;n++)n%2==1&&(i[n]=i[n].replace(/<\/span><span style="color:#\w{6};">/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;"));return a=i.join("```"),a=$("<div>"+a+"</div>").text().replace(/\n{2,}/g,"\n\n").replace(/ /g," "),$.trim(a)},Util.initUploadFile=function(e){$("#"+e.id).fileupload({multipart:!0,pasteZone:e.pasteZone,dropZone:e.pasteZone,url:latkeConfig.servePath+"/upload",paramName:"file[]",add:function(e,t){t.submit()},submit:function(t,a){if(e.editor.replaceRange){a.files.forEach(function(t){t.type.indexOf("image")>-1?e.uploadingLabel+="!["+t.name.replace(/\W/g,"")+"](Uploading...)":e.uploadingLabel+="["+t.name.replace(/\W/g,"")+"](Uploading...)"});var i=e.editor.getCursor();e.editor.replaceRange(e.uploadingLabel,i,i)}},done:function(t,a){var i=e.editor.getCursor();if(!a.result.sc){var n="";return a.files.forEach(function(e){e.type.indexOf("image")>-1?n+="!["+e.name.replace(/\W/g,"")+"]("+a.result.msg+")":n+="["+e.name.replace(/\W/g,"")+"]("+a.result.msg+")"}),void e.editor.replaceRange(n,CodeMirror.Pos(i.line,i.ch-e.uploadingLabel.length),i)}var l="";Object.keys(a.result.data.succMap).forEach(function(e){var t=!1;a.files.forEach(function(a){a.name.replace(/\W/g,"")===e&&(t=a.type.indexOf("image")>-1)}),l+=(t?"![":"[")+e.replace(/\W/g,"")+"]("+a.result.data.succMap[e]+") \n\n"}),a.result.data.errFiles.forEach(function(e){var t=!1;a.files.forEach(function(e){e.name.replace(/\W/g,"")===key&&(t=e.type.indexOf("image")>-1)}),l+=(t?"![":"[")+"["+e.replace(/\W/g,"")+"](Error)"}),e.editor.replaceRange(l,CodeMirror.Pos(i.line,i.ch-e.uploadingLabel.length),i)},fail:function(t,a){if(e.editor.replaceRange){var i="";a.files.forEach(function(e){e.type.indexOf("image")>-1?i+="!["+e.name.replace(/\W/g,"")+"]("+a.errorThrown+")":i+="["+e.name.replace(/\W/g,"")+"]("+a.errorThrown+")"});var n=e.editor.getCursor();e.editor.replaceRange("["+item.name.replace(/\W/g,"")+"]("+a.errorThrown+")",CodeMirror.Pos(n.line,n.ch-e.uploadingLabel.length),n)}}})},admin.editors.CodeMirror={init:function(e){var t="+1,-1,100,1234,8ball,a,ab,abc,abcd,accept,aerial_tramway,airplane,alarm_clock,alien,ambulance,anchor,angel,anger,angry,anguished,ant,apple,aquarius,aries,arrow_backward,arrow_double_down,arrow_double_up,arrow_down,arrow_down_small,arrow_forward,arrow_heading_down,arrow_heading_up,arrow_left,arrow_lower_left,arrow_lower_right,arrow_right,arrow_right_hook,arrow_up,arrow_up_down,arrow_up_small,arrow_upper_left,arrow_upper_right,arrows_clockwise,arrows_counterclockwise,art,articulated_lorry,astonished,atm,b,baby,baby_bottle,baby_chick,baby_symbol,back,baggage_claim,balloon,ballot_box_with_check,bamboo,banana,bangbang,bank,bar_chart,barber,baseball,basketball,bath,bathtub,battery,bear,bee,beer,beers,beetle,beginner,bell,bento,bicyclist,bike,bikini,bird,birthday,black_circle,black_joker,black_medium_small_square,black_medium_square,black_nib,black_small_square,black_square,black_square_button,blossom,blowfish,blue_book,blue_car,blue_heart,blush,boar,boat,bomb,book,bookmark,bookmark_tabs,books,boom,boot,bouquet,bow,bowling,bowtie,boy,bread,bride_with_veil,bridge_at_night,briefcase,broken_heart,bug,bulb,bullettrain_front,bullettrain_side,bus,busstop,bust_in_silhouette,busts_in_silhouette,cactus,cake,calendar,calling,camel,camera,cancer,candy,capital_abcd,capricorn,car,card_index,carousel_horse,cat,cat2,cd,chart,chart_with_downwards_trend,chart_with_upwards_trend,checkered_flag,cherries,cherry_blossom,chestnut,chicken,children_crossing,chocolate_bar,christmas_tree,church,cinema,circus_tent,city_sunrise,city_sunset,cl,clap,clapper,clipboard,clock1,clock10,clock1030,clock11,clock1130,clock12,clock1230,clock130,clock2,clock230,clock3,clock330,clock4,clock430,clock5,clock530,clock6,clock630,clock7,clock730,clock8,clock830,clock9,clock930,closed_book,closed_lock_with_key,closed_umbrella,cloud,clubs,cn,cocktail,coffee,cold_sweat,collision,computer,confetti_ball,confounded,confused,congratulations,construction,construction_worker,convenience_store,cookie,cool,cop,copyright,corn,couple,couple_with_heart,couplekiss,cow,cow2,credit_card,crescent_moon,crocodile,crossed_flags,crown,cry,crying_cat_face,crystal_ball,cupid,curly_loop,currency_exchange,curry,custard,customs,cyclone,dancer,dancers,dango,dart,dash,date,de,deciduous_tree,department_store,diamond_shape_with_a_dot_inside,diamonds,disappointed,disappointed_relieved,dizzy,dizzy_face,do_not_litter,dog,dog2,dollar,dolls,dolphin,donut,door,doughnut,dragon,dragon_face,dress,dromedary_camel,droplet,dvd,e-mail,ear,ear_of_rice,earth_africa,earth_americas,earth_asia,egg,eggplant,eight,eight_pointed_black_star,eight_spoked_asterisk,electric_plug,elephant,email,end,envelope,es,euro,european_castle,european_post_office,evergreen_tree,exclamation,expressionless,eyeglasses,eyes,facepunch,factory,fallen_leaf,family,fast_forward,fax,fearful,feelsgood,feet,ferris_wheel,file_folder,finnadie,fire,fire_engine,fireworks,first_quarter_moon,first_quarter_moon_with_face,fish,fish_cake,fishing_pole_and_fish,fist,five,flags,flashlight,floppy_disk,flower_playing_cards,flushed,foggy,football,fork_and_knife,fountain,four,four_leaf_clover,fr,free,fried_shrimp,fries,frog,frowning,fu,fuelpump,full_moon,full_moon_with_face,game_die,gb,gem,gemini,ghost,gift,gift_heart,girl,globe_with_meridians,goat,goberserk,godmode,golf,grapes,green_apple,green_book,green_heart,grey_exclamation,grey_question,grimacing,grin,grinning,guardsman,guitar,gun,haircut,hamburger,hammer,hamster,hand,handbag,hankey,hash,hatched_chick,hatching_chick,headphones,hear_no_evil,heart,heart_decoration,heart_eyes,heart_eyes_cat,heartbeat,heartpulse,hearts,heavy_check_mark,heavy_division_sign,heavy_dollar_sign,heavy_exclamation_mark,heavy_minus_sign,heavy_multiplication_x,heavy_plus_sign,helicopter,herb,hibiscus,high_brightness,high_heel,hocho,honey_pot,honeybee,horse,horse_racing,hospital,hotel,hotsprings,hourglass,hourglass_flowing_sand,house,house_with_garden,hurtrealbad,hushed,ice_cream,icecream,id,ideograph_advantage,imp,inbox_tray,incoming_envelope,information_desk_person,information_source,innocent,interrobang,iphone,it,izakaya_lantern,jack_o_lantern,japan,japanese_castle,japanese_goblin,japanese_ogre,jeans,joy,joy_cat,jp,key,keycap_ten,kimono,kiss,kissing,kissing_cat,kissing_closed_eyes,kissing_face,kissing_heart,kissing_smiling_eyes,koala,koko,kr,large_blue_circle,large_blue_diamond,large_orange_diamond,last_quarter_moon,last_quarter_moon_with_face,laughing,leaves,ledger,left_luggage,left_right_arrow,leftwards_arrow_with_hook,lemon,leo,leopard,libra,light_rail,link,lips,lipstick,lock,lock_with_ink_pen,lollipop,loop,loudspeaker,love_hotel,love_letter,low_brightness,m,mag,mag_right,mahjong,mailbox,mailbox_closed,mailbox_with_mail,mailbox_with_no_mail,man,man_with_gua_pi_mao,man_with_turban,mans_shoe,maple_leaf,mask,massage,meat_on_bone,mega,melon,memo,mens,metal,metro,microphone,microscope,milky_way,minibus,minidisc,mobile_phone_off,money_with_wings,moneybag,monkey,monkey_face,monorail,mortar_board,mount_fuji,mountain_bicyclist,mountain_cableway,mountain_railway,mouse,mouse2,movie_camera,moyai,muscle,mushroom,musical_keyboard,musical_note,musical_score,mute,nail_care,name_badge,neckbeard,necktie,negative_squared_cross_mark,neutral_face,new,new_moon,new_moon_with_face,newspaper,ng,nine,no_bell,no_bicycles,no_entry,no_entry_sign,no_good,no_mobile_phones,no_mouth,no_pedestrians,no_smoking,non-potable_water,nose,notebook,notebook_with_decorative_cover,notes,nut_and_bolt,o,o2,ocean,octocat,octopus,oden,office,ok,ok_hand,ok_woman,older_man,older_woman,on,oncoming_automobile,oncoming_bus,oncoming_police_car,oncoming_taxi,one,open_file_folder,open_hands,open_mouth,ophiuchus,orange_book,outbox_tray,ox,package,page_facing_up,page_with_curl,pager,palm_tree,panda_face,paperclip,parking,part_alternation_mark,partly_sunny,passport_control,paw_prints,peach,pear,pencil,pencil2,penguin,pensive,performing_arts,persevere,person_frowning,person_with_blond_hair,person_with_pouting_face,phone,pig,pig2,pig_nose,pill,pineapple,pisces,pizza,plus1,point_down,point_left,point_right,point_up,point_up_2,police_car,poodle,poop,post_office,postal_horn,postbox,potable_water,pouch,poultry_leg,pound,pouting_cat,pray,princess,punch,purple_heart,purse,pushpin,put_litter_in_its_place,question,rabbit,rabbit2,racehorse,radio,radio_button,rage,rage1,rage2,rage3,rage4,railway_car,rainbow,raised_hand,raised_hands,raising_hand,ram,ramen,rat,recycle,red_car,red_circle,registered,relaxed,relieved,repeat,repeat_one,restroom,revolving_hearts,rewind,ribbon,rice,rice_ball,rice_cracker,rice_scene,ring,rocket,roller_coaster,rooster,rose,rotating_light,round_pushpin,rowboat,ru,rugby_football,runner,running,running_shirt_with_sash,sa,sagittarius,sailboat,sake,sandal,santa,satellite,satisfied,saxophone,school,school_satchel,scissors,scorpius,scream,scream_cat,scroll,seat,secret,see_no_evil,seedling,seven,shaved_ice,sheep,shell,ship,shipit,shirt,shit,shoe,shower,signal_strength,six,six_pointed_star,ski,skull,sleeping,sleepy,slot_machine,small_blue_diamond,small_orange_diamond,small_red_triangle,small_red_triangle_down,smile,smile_cat,smiley,smiley_cat,smiling_imp,smirk,smirk_cat,smoking,snail,snake,snowboarder,snowflake,snowman,sob,soccer,soon,sos,sound,space_invader,spades,spaghetti,sparkle,sparkler,sparkles,sparkling_heart,speak_no_evil,speaker,speech_balloon,speedboat,squirrel,star,star2,stars,station,statue_of_liberty,steam_locomotive,stew,straight_ruler,strawberry,stuck_out_tongue,stuck_out_tongue_closed_eyes,stuck_out_tongue_winking_eye,sun_with_face,sunflower,sunglasses,sunny,sunrise,sunrise_over_mountains,surfer,sushi,suspect,suspension_railway,sweat,sweat_drops,sweat_smile,sweet_potato,swimmer,symbols,syringe,tada,tanabata_tree,tangerine,taurus,taxi,tea,telephone,telephone_receiver,telescope,tennis,tent,thought_balloon,three,thumbsdown,thumbsup,ticket,tiger,tiger2,tired_face,tm,toilet,tokyo_tower,tomato,tongue,top,tophat,tractor,traffic_light,train,train2,tram,triangular_flag_on_post,triangular_ruler,trident,triumph,trolleybus,trollface,trophy,tropical_drink,tropical_fish,truck,trumpet,tshirt,tulip,turtle,tv,twisted_rightwards_arrows,two,two_hearts,two_men_holding_hands,two_women_holding_hands,u5272,u5408,u55b6,u6307,u6708,u6709,u6e80,u7121,u7533,u7981,u7a7a,uk,umbrella,unamused,underage,unlock,up,us,v,vertical_traffic_light,vhs,vibration_mode,video_camera,video_game,violin,virgo,volcano,vs,walking,waning_crescent_moon,waning_gibbous_moon,warning,watch,water_buffalo,watermelon,wave,wavy_dash,waxing_crescent_moon,waxing_gibbous_moon,wc,weary,wedding,whale,whale2,wheelchair,white_check_mark,white_circle,white_flower,white_large_square,white_medium_small_square,white_medium_square,white_small_square,white_square_button,wind_chime,wine_glass,wink,wolf,woman,womans_clothes,womans_hat,womens,worried,wrench,x,yellow_heart,yen,yum,zap,zero,zzz".split(",");CodeMirror.registerHelper("hint","emoji",function(e){for(var a=/[\w$]+/,i=e.getCursor(),n=e.getLine(i.line),l=i.ch,o=l;o<n.length&&a.test(n.charAt(o));)++o;for(;l&&a.test(n.charAt(l-1));)--l;for(var s=e.getTokenAt(i),r=[],c=s.string.trim(),d=0,g=0;g<t.length;g++){var p=t[g],u=t[g];if(Util.startsWith(u,c)&&(r.push({displayText:'<span style="font-size: 1rem;line-height:22px"><img style="width: 1rem;margin:3px 0;float:left" src="'+latkeConfig.servePath+"/js/lib/emojify.js-1.1.0/images/basic/"+u+'.png"> '+p.toString()+"</span>",text:":"+u+": "}),d++),d>10)break}return{list:r,from:CodeMirror.Pos(i.line,l),to:CodeMirror.Pos(i.line,o)}}),CodeMirror.commands.autocompleteEmoji=function(e){return e.showHint({hint:CodeMirror.hint.emoji,completeSingle:!1}),CodeMirror.Pass};var a=new Editor({element:document.getElementById(e.id),dragDrop:!1,lineWrapping:!0,status:!1,htmlURL:latkeConfig.servePath+"/console/markdown/2html",toolbar:[{name:"bold"},{name:"italic"},{name:"quote"},{name:"link"},{name:"unordered-list"},{name:"ordered-list"},{name:"image",html:'<span style="display: inline-block;top:1px" class="tooltipped tooltipped-n" aria-label="'+Label.uploadFilesLabel+'" ><form id="'+e.id+'fileUpload" method="POST" enctype="multipart/form-data"><label class="icon-upload"><input type="file"/></label></form></span>'},{name:"redo"},{name:"undo"},{name:"preview"},{name:"fullscreen"}],extraKeys:{"Cmd-/":"autocompleteEmoji","Ctrl-/":"autocompleteEmoji"}});a.render(),Util.initUploadFile({id:e.id+"fileUpload",pasteZone:$("#"+e.id).next().next(),qiniuUploadToken:qiniu.qiniuUploadToken,editor:a.codemirror,uploadingLabel:"",qiniuDomain:"//"+qiniu.qiniuDomain}),this[e.id]=a.codemirror,this[e.id].on("changes",function(t){if(0===$("#"+e.id).parent().find(".CodeMirror-preview").length)return!1;$.ajax({url:latkeConfig.servePath+"/console/markdown/2html",type:"POST",cache:!1,data:{markdownText:t.getValue()},success:function(t,a){$("#"+e.id).parent().find(".CodeMirror-preview").html(t.html),hljs.initHighlighting.called=!1,hljs.initHighlighting()}})}),"function"==typeof e.fun&&e.fun()},getContent:function(e){return this[e].getValue()},setContent:function(e,t){this[e].setValue(t),$("#"+e).parent().find(".markdown-preivew").find(".markdown-preview-main").html(t)},remove:function(e){this[e].toTextArea(),$(".editor-toolbar").remove()}};var TablePaginate=function(e){this.id=e,this.currentPage=1};$.extend(TablePaginate.prototype,{buildTable:function(e,t){var a={colModel:e,noDataTip:Label.noDataLabel};t||(a.expendRow={index:"expendRow"}),$("#"+this.id+"Table").table(a)},initPagination:function(){var e=this.id;$("#"+e+"Pagination").paginate({bind:function(e,t){t?$("#tipMsg").text(t):admin.setHashByPage(e)},currentPage:1,errorMessage:Label.inputErrorLabel,nextPageText:">",previousPageText:"<",goText:Label.gotoLabel,type:"custom",custom:[1],pageCount:1})},initCommentsDialog:function(){var e=this;$("#"+this.id+"Comments").dialog({modal:!0,hideFooter:!0,close:function(){return admin[e.id+"List"].getList(e.currentPage),!0}})},updateTablePagination:function(e,t,a){if((t=parseInt(t))>a.paginationPageCount&&t>1)return $("#tipMsg").text(Label.pageLabel+t+Label.notFoundLabel),void $("#loadMsg").text("");$("#"+this.id+"Table").table("update",{data:[{groupName:"all",groupData:e}]}),0===a.paginationPageCount&&(a.paginationPageCount=1),$("#"+this.id+"Pagination").paginate("update",{pageCount:a.paginationPageCount,currentPage:t,custom:a.paginationPageNums}),this.currentPage=t}}),admin.article={currentEditorType:"",isConfirm:!0,status:{id:void 0,isArticle:void 0,articleHadBeenPublished:void 0},content:"",autoSaveDraftTimer:"",AUTOSAVETIME:6e4,get:function(e,t){this.status.id=e,this.status.isArticle=t,admin.selectTab("article/article")},getAndSet:function(){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),$.ajax({url:latkeConfig.servePath+"/console/article/"+admin.article.status.id,type:"GET",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");$("#title").val(e.article.articleTitle),admin.article.status.articleHadBeenPublished=e.article.articleHadBeenPublished,admin.article.currentEditorType!==e.article.articleEditorType&&(admin.editors.articleEditor.remove(),admin.editors.abstractEditor.remove(),admin.article.currentEditorType=e.article.articleEditorType,admin.editors.articleEditor.init(e.article.articleEditorType),admin.editors.abstractEditor.init(e.article.articleEditorType)),admin.editors.articleEditor.setContent(e.article.articleContent),admin.editors.abstractEditor.setContent(e.article.articleAbstract),admin.article.content=admin.editors.articleEditor.getContent();for(var a=e.article.articleTags,i="",n=0;n<a.length;n++)0===n?i=a[n].tagTitle:i+=","+a[n].tagTitle;$("#tag").val(i),$("#permalink").val(e.article.articlePermalink),$("#viewPwd").val(e.article.articleViewPwd),$("#articleCommentable").prop("checked",e.article.articleCommentable);var l=e.article.signs;$(".signs button").each(function(t){parseInt(e.article.articleSignId)===parseInt(l[t].oId)?$("#articleSign"+l[t].oId).addClass("selected"):$("#articleSign"+l[t].oId).removeClass("selected")}),admin.article.setStatus(),$("#loadMsg").text("")}})},del:function(e,t,a){confirm(Label.confirmRemoveLabel+Label.articleLabel+'"'+a+'"?')&&($("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),$.ajax({url:latkeConfig.servePath+"/console/article/"+e,type:"DELETE",cache:!1,success:function(e,a){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");admin[t+"List"].getList(1)}}))},add:function(e,t){if(admin.article.validate()){var a=this;a._addDisabled(),$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var i="";$(".signs button").each(function(){"selected"===this.className&&(i=this.id.substr(this.id.length-1,1))});var n=admin.editors.articleEditor.getContent(),l=admin.editors.abstractEditor.getContent();if($("#articleThumbnail").prop("checked")){var o=$(".thumbnail__img").css("background-image");n="![]("+o.substring(5,o.length-2)+")\n\n"+n}var s={article:{articleTitle:$("#title").val(),articleContent:n,articleAbstract:l,articleTags:this.trimUniqueArray($("#tag").val()).toString(),articlePermalink:$("#permalink").val(),articleIsPublished:e,articleSignId:i,postToCommunity:$("#postToCommunity").prop("checked"),articleCommentable:$("#articleCommentable").prop("checked"),articleViewPwd:$("#viewPwd").val()}};$.ajax({url:latkeConfig.servePath+"/console/article/",type:"POST",cache:!1,data:JSON.stringify(s),success:function(a,i){if(t)return $("#tipMsg").text(Label.autoSaveLabel),void(admin.article.status.id=a.oId);$("#tipMsg").text(a.msg),a.sc&&(e?(admin.article.status.id=void 0,admin.selectTab("article/article-list")):admin.selectTab("article/draft-list"),admin.article.isConfirm=!1)},complete:function(t,i){a._removeDisabled(),$("#loadMsg").text(""),403===t.status&&($.get("/admin-index.do"),a.add(e))}})}},update:function(e,t){if(admin.article.validate()){var a=this;a._addDisabled(),$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var i="";$(".signs button").each(function(){"selected"===this.className&&(i=this.id.substr(this.id.length-1,1))});var n=admin.editors.articleEditor.getContent(),l=admin.editors.abstractEditor.getContent();if($("#articleThumbnail").prop("checked")){var o=$(".thumbnail__img").css("background-image");n="![]("+o.substring(5,o.length-2)+") \n\n"+n}var s={article:{oId:this.status.id,articleTitle:$("#title").val(),articleContent:n,articleAbstract:l,articleTags:this.trimUniqueArray($("#tag").val()).toString(),articlePermalink:$("#permalink").val(),articleIsPublished:e,articleSignId:i,articleCommentable:$("#articleCommentable").prop("checked"),articleViewPwd:$("#viewPwd").val(),postToCommunity:$("#postToCommunity").prop("checked"),articleEditorType:admin.article.currentEditorType}};$.ajax({url:latkeConfig.servePath+"/console/article/",type:"PUT",cache:!1,data:JSON.stringify(s),success:function(a,i){if(t)return void $("#tipMsg").text(Label.autoSaveLabel);$("#tipMsg").text(a.msg),a.sc&&(e?admin.selectTab("article/article-list"):admin.selectTab("article/draft-list"),$("#tipMsg").text(Label.updateSuccLabel),admin.article.status.id=void 0,admin.article.isConfirm=!1)},complete:function(t,i){a._removeDisabled(),$("#loadMsg").text(""),403===t.status&&($.get("/admin-index.do"),a.update(e))}})}},setStatus:function(){$.ajax({url:latkeConfig.servePath+"/console/tags",type:"GET",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");if(!(0>=e.tags.length)){$("#tagCheckboxPanel>span").remove("");for(var a="",i=0;i<e.tags.length;i++)a+="<span>"+e.tags[i].tagTitle+"</span>";$("#tagCheckboxPanel").html(a+'<div class="clear"></div>'),$("#loadMsg").text("")}}}),this.status?(this.status.isArticle?($("#unSubmitArticle").show(),$("#saveArticle").hide(),$("#submitArticle").show()):($("#submitArticle").show(),$("#unSubmitArticle").hide(),$("#saveArticle").show()),this.status.articleHadBeenPublished&&$("#postToCommunityPanel").hide()):($("#submitArticle").show(),$("#unSubmitArticle").hide(),$("#saveArticle").show()),$("#postToCommunity").attr("checked","checked")},clear:function(){this.status={id:void 0,isArticle:void 0,articleHadBeenPublished:void 0},this.setStatus(),$("#title").val(""),admin.editors.articleEditor.setContent(""),admin.editors.abstractEditor.setContent(""),$("#tag").val(""),$("#tagCheckboxPanel").hide().find("span").removeClass("selected"),$("#permalink").val(""),$("#articleCammentable").prop("checked",!0),$("#postToCommunity").prop("checked",!0),$(".signs button").each(function(e){this.className=0===e?"selected":""}),$(".editor-preview-active").html("").removeClass("editor-preview-active"),$("#uploadContent").remove(),$("#articleThumbnail").prop("checked")&&$("#articleThumbnail").click()},init:function(e){this.currentEditorType=Label.editorType,$(".signs button").click(function(e){$(".signs button").removeClass("selected"),$(this).addClass("selected")}),$.ajax({url:latkeConfig.servePath+"/console/tags",type:"GET",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");if(!(0>=e.tags.length)){for(var a=[],i=0;i<e.tags.length;i++)a.push(e.tags[i].tagTitle);$("#tag").completed({height:160,buttonText:Label.selectLabel,data:a}),$("#loadMsg").text("")}}}),$("#submitArticle").click(function(){admin.article.status.id?admin.article.update(!0):admin.article.add(!0)}),$("#saveArticle").click(function(){admin.article.status.id?admin.article.update(admin.article.status.isArticle):admin.article.add(!1)}),admin.editors.articleEditor=new SoloEditor({id:"articleContent",kind:"all",fun:e,height:500}),admin.editors.abstractEditor=new SoloEditor({id:"abstract",kind:"simple",height:200}),admin.article.clearDraftTimer(),admin.article.autoSaveDraftTimer=setInterval(function(){admin.article._autoSaveToDraft()},admin.article.AUTOSAVETIME),$("#articleThumbnailBtn").click(function(){$.ajax({url:latkeConfig.servePath+"/console/thumbs?n=1",type:"GET",cache:!1,success:function(e,t){if(!e.sc)return void $("#loadMsg").text(e.msg);$("#articleThumbnailBtn").prev().css("background-image","url("+e.data[0]+")")}})}).click()},_autoSaveToDraft:function(){""!==$("#title").val().replace(/\s/g,"")&&""!==admin.editors.articleEditor.getContent().replace(/\s/g,"")&&""!==$("#tag").val().replace(/\s/g,"")&&(admin.article.status.id?admin.article.status.isArticle||admin.article.update(!1,!0):(admin.article.add(!1,!0),admin.article.status.isArticle=!1))},clearDraftTimer:function(){""!==admin.article.autoSaveDraftTimer&&(window.clearInterval(admin.article.autoSaveDraftTimer),admin.article.autoSaveDraftTimer="")},validate:function(){var e=admin.editors.articleEditor.getContent();if(""===$("#title").val().replace(/\s/g,""))$("#tipMsg").text(Label.titleEmptyLabel),$("#title").focus().val("");else if(""===e.replace(/\s/g,""))$("#tipMsg").text(Label.contentEmptyLabel);else{if(""!==$("#tag").val().replace(/\s/g,""))return!0;$("#tipMsg").text(Label.tagsEmptyLabel),$("#tag").focus().val("")}return!1},unPublish:function(e){var t=this;t._addDisabled(),$.ajax({url:latkeConfig.servePath+"/console/article/unpublish/"+admin.article.status.id,type:"PUT",cache:!1,success:function(t,a){if(e)return void $("#tipMsg").text(Label.autoSaveLabel);$("#tipMsg").text(t.msg),t.sc&&(admin.selectTab("article/draft-list"),admin.article.status.id=void 0,admin.article.isConfirm=!1)},complete:function(e,a){t._removeDisabled(),$("#loadMsg").text(""),403===e.status&&($.get("/admin-index.do"),t.unPublish())}})},trimUniqueArray:function(e){e=e.toString()
;for(var t=e.split(","),a=0;a<t.length;a++)t[a]=t[a].replace(/(^\s*)|(\s*$)/g,""),""===t[a]&&(t.splice(a,1),a--);return $.unique(t).toString()},prePost:function(){if($("#loadMsg").text(Label.loadingLabel),admin.article.content="",admin.editors.articleEditor.getContent){var e=admin.editors.articleEditor.getContent();"#article/article"===window.location.hash&&""!==e.replace(/\s/g,"")&&confirm(Label.editorPostLabel)&&admin.article.clear(),$("#tipMsg").text(""),$("#loadMsg").text(""),admin.article.currentEditorType!==Label.editorType&&(admin.editors.articleEditor.remove(),admin.editors.abstractEditor.remove(),admin.article.currentEditorType=Label.editorType,admin.editors.articleEditor.init(Label.editorType),admin.editors.abstractEditor.init(Label.editorType))}},_addDisabled:function(){$("#unSubmitArticle").attr("disabled","disabled"),$("#saveArticle").attr("disabled","disabled"),$("#submitArticle").attr("disabled","disabled")},_removeDisabled:function(){$("#unSubmitArticle").removeAttr("disabled"),$("#saveArticle").removeAttr("disabled"),$("#submitArticle").removeAttr("disabled")}},admin.register.article={obj:admin.article,init:admin.article.init,refresh:function(){admin.editors.abstractEditor.setContent(""),admin.editors.articleEditor.setContent(""),$("#loadMsg").text(""),$("#tipMsg").text("")}},admin.comment={open:function(e,t){this.getList(e,t),$("#"+t+"Comments").dialog("open")},getList:function(e,t){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),$("#"+t+"Comments").html("");var a="article";"page"===t&&(a="page"),$.ajax({url:latkeConfig.servePath+"/console/comments/"+a+"/"+e,type:"GET",cache:!1,success:function(a,i){if($("#tipMsg").text(a.msg),!a.sc)return void $("#loadMsg").text("");for(var n=a.comments,l="",o=0;o<n.length;o++){var s="<a target='_blank' href='"+n[o].commentURL+"'>",r=n[o].commentContent,c=Util.replaceEmString(r);"http://"===n[o].commentURL&&(s="<a target='_blank'>"),l+="<div class='comment-title'><span class='left'>"+s+n[o].commentName+"</a>",n[o].commentOriginalCommentName&&(l+="@"+n[o].commentOriginalCommentName),l+="</span><span title='"+Label.removeLabel+"' class='right deleteIcon' onclick=\"admin.comment.del('"+n[o].oId+"', '"+t+"', '"+e+"')\"></span><span class='right'><a href='mailto:"+n[o].commentEmail+"'>"+n[o].commentEmail+"</a>&nbsp;&nbsp;"+$.bowknot.getDate(n[o].commentTime)+"&nbsp;</span><div class='clear'></div></div><div class='margin12'>"+c+"</div>"}""===l&&(l=Label.noCommentLabel),$("#"+t+"Comments").html(l),$("#loadMsg").text("")}})},del:function(e,t,a){if(confirm(Label.confirmRemoveLabel+Label.commentLabel+"?")){$("#loadMsg").text(Label.loadingLabel);var i="article";"page"===t&&(i="page"),$.ajax({url:latkeConfig.servePath+"/console/"+i+"/comment/"+e,type:"DELETE",cache:!1,success:function(e,i){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");admin.comment.getList(a,t),$("#loadMsg").text("")}})}}},admin.articleList={tablePagination:new TablePaginate("article"),init:function(e){this.tablePagination.buildTable([{text:Label.titleLabel,index:"title",minWidth:110,style:"padding-left: 12px;font-size:14px;"},{text:Label.authorLabel,index:"author",width:150,style:"padding-left: 12px;"},{text:Label.commentLabel,index:"comments",width:80,style:"padding-left: 12px;"},{text:Label.viewLabel,width:60,index:"articleViewCount",style:"padding-left: 12px;"},{text:Label.dateLabel,index:"date",width:90,style:"padding-left: 12px;"}]),this.tablePagination.initPagination(),this.tablePagination.initCommentsDialog(),this.getList(e)},getList:function(e){var t=this;$("#loadMsg").text(Label.loadingLabel),$.ajax({url:latkeConfig.servePath+"/console/articles/status/published/"+e+"/"+Label.PAGE_SIZE+"/"+Label.WINDOW_SIZE,type:"GET",cache:!1,success:function(a,i){if($("#tipMsg").text(a.msg),!a.sc)return void $("#loadMsg").text("");for(var n=a.articles,l=[],o=0;o<n.length;o++){l[o]={},l[o].title='<a href="'+latkeConfig.servePath+n[o].articlePermalink+"\" target='_blank' title='"+n[o].articleTitle+"' class='no-underline'>"+n[o].articleTitle+"</a><span class='table-tag'>"+n[o].articleTags+"</span>",l[o].date=$.bowknot.getDate(n[o].articleCreateTime),l[o].comments=n[o].articleCommentCount,l[o].articleViewCount=n[o].articleViewCount,l[o].author=n[o].authorName;var s=n[o].articlePutTop?Label.cancelPutTopLabel:Label.putTopLabel;l[o].expendRow="<a target='_blank' href='"+latkeConfig.servePath+n[o].articlePermalink+"'>"+Label.viewLabel+"</a>                                  <a href='javascript:void(0)' onclick=\"admin.article.get('"+n[o].oId+"', true)\">"+Label.updateLabel+"</a>                                  <a href='javascript:void(0)' onclick=\"admin.article.del('"+n[o].oId+"', 'article', '"+Util.addslashes(n[o].articleTitle)+"')\">"+Label.removeLabel+"</a>                                  <a href='javascript:void(0)' onclick=\"admin.articleList.popTop(this, '"+n[o].oId+"')\">"+s+"</a>                                  <a href='javascript:void(0)' onclick=\"admin.comment.open('"+n[o].oId+"', 'article')\">"+Label.commentLabel+"</a>"}t.tablePagination.updateTablePagination(l,e,a.pagination),$("#loadMsg").text("")}})},popTop:function(e,t){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var a=$(e),i="canceltop",n=Label.putTopLabel;a.html()===Label.putTopLabel&&(i="puttop",n=Label.cancelPutTopLabel),$.ajax({url:latkeConfig.servePath+"/console/article/"+i+"/"+t,type:"PUT",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");a.html(n),$("#loadMsg").text("")}})}},admin.register["article-list"]={obj:admin.articleList,init:admin.articleList.init,refresh:admin.articleList.getList},admin.draftList={tablePagination:new TablePaginate("draft"),init:function(e){this.tablePagination.buildTable([{text:Label.titleLabel,index:"title",minWidth:110,style:"padding-left: 12px;font-size:14px;"},{text:Label.authorLabel,index:"author",width:150,style:"padding-left: 12px;"},{text:Label.commentLabel,index:"comments",width:80,style:"padding-left: 12px;"},{text:Label.viewLabel,width:60,index:"articleViewCount",style:"padding-left: 12px;"},{text:Label.dateLabel,index:"date",width:90,style:"padding-left: 12px;"}]),this.tablePagination.initPagination(),this.tablePagination.initCommentsDialog(),this.getList(e)},getList:function(e){$("#loadMsg").text(Label.loadingLabel);var t=this;$.ajax({url:latkeConfig.servePath+"/console/articles/status/unpublished/"+e+"/"+Label.PAGE_SIZE+"/"+Label.WINDOW_SIZE,type:"GET",cache:!1,success:function(a,i){if($("#tipMsg").text(a.msg),!a.sc)return void $("#loadMsg").text("");for(var n=a.articles,l=[],o=0;o<n.length;o++)l[o]={},l[o].tags=n[o].articleTags,l[o].date=$.bowknot.getDate(n[o].articleCreateTime),l[o].comments=n[o].articleCommentCount,l[o].articleViewCount=n[o].articleViewCount,l[o].author=n[o].authorName,l[o].title="<a class='no-underline' href='"+latkeConfig.servePath+n[o].articlePermalink+"' target='_blank'>"+n[o].articleTitle+"</a><span class='table-tag'>"+n[o].articleTags+"</span>",l[o].expendRow="<a href='javascript:void(0)' onclick=\"admin.article.get('"+n[o].oId+"', false);\">"+Label.updateLabel+"</a>                                  <a href='javascript:void(0)' onclick=\"admin.article.del('"+n[o].oId+"', 'draft', '"+Util.addslashes(n[o].articleTitle)+"')\">"+Label.removeLabel+"</a>                                  <a href='javascript:void(0)' onclick=\"admin.comment.open('"+n[o].oId+"', 'draft')\">"+Label.commentLabel+"</a>";t.tablePagination.updateTablePagination(l,e,a.pagination),$("#loadMsg").text("")}})}},admin.register["draft-list"]={obj:admin.draftList,init:admin.draftList.init,refresh:admin.draftList.getList},admin.pageList={currentEditorType:"",tablePagination:new TablePaginate("page"),pageInfo:{currentCount:1,pageCount:1,currentPage:1},id:"",type:"link",init:function(e){this.tablePagination.buildTable([{text:"",index:"pageOrder",width:60,style:"padding-left: 12px;font-size:14px;"},{style:"padding-left: 12px;",text:Label.titleLabel,index:"pageTitle",width:300},{style:"padding-left: 12px;",text:Label.permalinkLabel,index:"pagePermalink",minWidth:100},{style:"padding-left: 12px;",text:Label.openMethodLabel,index:"pageTarget",width:120},{style:"padding-left: 12px;",text:Label.typeLabel,index:"pageType",width:80},{text:Label.commentLabel,index:"comments",width:80,style:"padding-left: 12px;"}]),this.tablePagination.initPagination(),this.tablePagination.initCommentsDialog(),this.getList(e);var t=Label.localeString.substring(0,2);"zh"===t&&(t="zh-cn"),admin.pageList.currentEditorType=Label.editorType,admin.editors.pageEditor=new SoloEditor({language:t,kind:"all",id:"pageContent"}),$(".fn-type").click(function(){var e=$(this);e.hasClass("selected")||($(".fn-type").removeClass("selected"),e.addClass("selected"),admin.pageList.type=e.data("type"),"page"===admin.pageList.type?($("#pagePagePanel").slideDown(),"CodeMirror-Markdown"===Label.editorType&&""===admin.editors.pageEditor.getContent()&&admin.editors.pageEditor.setContent("")):$("#pagePagePanel").slideUp())})},getList:function(e){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var t=this;$.ajax({url:latkeConfig.servePath+"/console/pages/"+e+"/"+Label.PAGE_SIZE+"/"+Label.WINDOW_SIZE,type:"GET",cache:!1,success:function(a,i){if($("#tipMsg").text(a.msg),!a.sc)return void $("#loadMsg").text("");var n=a.pages,l=[];admin.pageList.pageInfo.currentCount=n.length,admin.pageList.pageInfo.pageCount=0===a.pagination.paginationPageCount?1:a.pagination.paginationPageCount;for(var o=0;o<n.length;o++){l[o]={},0===o?1===n.length?l[o].pageOrder="":l[o].pageOrder='<div class="table-center" style="width:14px">                                        <span onclick="admin.pageList.changeOrder('+n[o].oId+", "+o+', \'down\');"                                         class="icon-move-down"></span></div>':o===n.length-1?l[o].pageOrder='<div class="table-center" style="width:14px">                                    <span onclick="admin.pageList.changeOrder('+n[o].oId+", "+o+', \'up\');" class="icon-move-up"></span>                                    </div>':l[o].pageOrder='<div class="table-center" style="width:38px">                                    <span onclick="admin.pageList.changeOrder('+n[o].oId+", "+o+', \'up\');" class="icon-move-up"></span>                                    <span onclick="admin.pageList.changeOrder('+n[o].oId+", "+o+', \'down\');" class="icon-move-down"></span>                                    </div>';var s="";""!==n[o].pageIcon&&(s="<img class='navigation-icon' src='"+n[o].pageIcon+"'/> "),l[o].pageTitle=s+"<a class='no-underline' href='"+n[o].pagePermalink+"' target='_blank'>"+n[o].pageTitle+"</a>",l[o].pagePermalink="<a class='no-underline' href='"+n[o].pagePermalink+"' target='_blank'>"+n[o].pagePermalink+"</a>",l[o].pageTarget=n[o].pageOpenTarget,l[o].pageType=n[o].pageType,l[o].comments=n[o].pageCommentCount,l[o].expendRow="<span><a href='"+n[o].pagePermalink+"' target='_blank'>"+Label.viewLabel+"</a>                                  <a href='javascript:void(0)' onclick=\"admin.pageList.get('"+n[o].oId+"')\">"+Label.updateLabel+"</a>                                <a href='javascript:void(0)' onclick=\"admin.pageList.del('"+n[o].oId+"', '"+n[o].pageTitle+"')\">"+Label.removeLabel+"</a>                                <a href='javascript:void(0)' onclick=\"admin.comment.open('"+n[o].oId+"', 'page')\">"+Label.commentLabel+"</a></span>"}t.tablePagination.updateTablePagination(l,e,a.pagination),$("#loadMsg").text("")}})},get:function(e){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),$.ajax({url:latkeConfig.servePath+"/console/page/"+e,type:"GET",cache:!1,success:function(t,a){if($("#tipMsg").text(t.msg),!t.sc)return void $("#loadMsg").text("");admin.pageList.id=e,$("#pageTitle").val(t.page.pageTitle),$("#pagePermalink").val(t.page.pagePermalink),$("#pageTarget").val(t.page.pageOpenTarget),$("#pageIcon").val(t.page.pageIcon),"page"===t.page.pageType?$($(".fn-type").get(1)).click():$($(".fn-type").get(0)).click(),$("#pageCommentable").prop("checked",t.page.pageCommentable),admin.pageList.currentEditorType!==t.page.pageEditorType&&(admin.editors.pageEditor.remove(),admin.pageList.currentEditorType=t.page.pageEditorType,admin.editors.pageEditor.init(t.page.pageEditorType)),admin.editors.pageEditor.setContent(t.page.pageContent),$("#loadMsg").text("")}})},del:function(e,t){confirm(Label.confirmRemoveLabel+Label.navLabel+'"'+t+'"?')&&($("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),$.ajax({url:latkeConfig.servePath+"/console/page/"+e,type:"DELETE",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");var a=admin.pageList.pageInfo.currentPage;1===admin.pageList.pageInfo.currentCount&&1!==admin.pageList.pageInfo.pageCount&&admin.pageList.pageInfo.currentPage===admin.pageList.pageInfo.pageCount&&(admin.pageList.pageInfo.pageCount--,a=admin.pageList.pageInfo.pageCount);var i=window.location.hash.split("/");a==i[i.length-1]?admin.pageList.getList(a):admin.setHashByPage(a),$("#loadMsg").text("")}}))},add:function(){if(this.validate()){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var e=admin.editors.pageEditor.getContent(),t=$("#pagePermalink").val().replace(/(^\s*)|(\s*$)/g,"");"link"===admin.pageList.type&&(t=Util.proessURL(t));var a={page:{pageTitle:$("#pageTitle").val(),pageContent:e,pagePermalink:t,pageCommentable:$("#pageCommentable").prop("checked"),pageType:admin.pageList.type,pageOpenTarget:$("#pageTarget").val(),pageIcon:$("#pageIcon").val()}};$.ajax({url:latkeConfig.servePath+"/console/page/",type:"POST",cache:!1,data:JSON.stringify(a),success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");admin.pageList.id="",$("#pagePermalink").val(""),$("#pageTitle").val(""),$("#pageIcon").val(""),$("#pageCommentable").prop("cheked",!1),$("#pageTarget").val("_self"),$($(".fn-type").get(0)).click(),admin.editors.pageEditor.setContent(""),admin.pageList.pageInfo.currentCount===Label.PAGE_SIZE&&admin.pageList.pageInfo.currentPage===admin.pageList.pageInfo.pageCount&&admin.pageList.pageInfo.pageCount++;var a=window.location.hash.split("/");admin.pageList.pageInfo.pageCount==a[a.length-1]?admin.pageList.getList(admin.pageList.pageInfo.pageCount):admin.setHashByPage(admin.pageList.pageInfo.pageCount),$("#loadMsg").text("")}})}},update:function(){if(this.validate()){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var e=admin.editors.pageEditor.getContent(),t=$("#pagePermalink").val().replace(/(^\s*)|(\s*$)/g,"");"link"===admin.pageList.type&&(t=Util.proessURL(t));var a={page:{pageTitle:$("#pageTitle").val(),oId:this.id,pageContent:e,pagePermalink:t,pageCommentable:$("#pageCommentable").prop("checked"),pageType:admin.pageList.type,pageOpenTarget:$("#pageTarget").val(),pageEditorType:admin.pageList.currentEditorType,pageIcon:$("#pageIcon").val()}};$.ajax({url:latkeConfig.servePath+"/console/page/",type:"PUT",cache:!1,data:JSON.stringify(a),success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");admin.pageList.id="",admin.pageList.getList(admin.pageList.pageInfo.currentPage),$("#pageTitle").val(""),$("#pageIcon").val(""),$("#pagePermalink").val(""),$("#pageCommentable").prop("cheked",!1),$("#pageTarget").val("_self"),$($(".fn-type").get(0)).click(),admin.editors.pageEditor.setContent(""),$("#loadMsg").text("")}})}},validate:function(){if(""===$("#pageTitle").val().replace(/\s/g,""))$("#tipMsg").text(Label.titleEmptyLabel),$("#pageTitle").focus();else{if("link"!==admin.pageList.type||""!==$("#pagePermalink").val().replace(/\s/g,""))return!0;$("#tipMsg").text(Label.linkEmptyLabel)}return!1},submit:function(){""!==this.id?this.update():this.add(),admin.pageList.currentEditorType!==Label.editorType&&(admin.editors.pageEditor.remove(),admin.pageList.currentEditorType=Label.editorType,admin.editors.pageEditor.init(Label.editorType))},changeOrder:function(e,t,a){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var i={oId:e.toString(),direction:a};$.ajax({url:latkeConfig.servePath+"/console/page/order/",type:"PUT",cache:!1,data:JSON.stringify(i),success:function(e,t){$("#tipMsg").text(e.msg),admin.pageList.getList(admin.pageList.pageInfo.currentPage),$("#loadMsg").text("")}})}},admin.register["page-list"]={obj:admin.pageList,init:admin.pageList.init,refresh:admin.pageList.getList},admin.others={init:function(){$("#tabOthers").tabs(),$.ajax({url:latkeConfig.servePath+"/console/reply/notification/template",type:"GET",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");$("#replayEmailTemplateTitle").val(e.replyNotificationTemplate.subject),$("#replayEmailTemplateBody").val(e.replyNotificationTemplate.body),$("#loadMsg").text("")}})},removeUnusedTags:function(){$("#tipMsg").text(""),$.ajax({url:latkeConfig.servePath+"/console/tag/unused",type:"DELETE",cache:!1,success:function(e,t){$("#tipMsg").text(e.msg)}})},exportSQL:function(){$("#tipMsg").text(""),$.ajax({url:latkeConfig.servePath+"/console/export/sql",type:"GET",cache:!1,success:function(e,t){e.sc?$("#tipMsg").text(e.msg):window.location=latkeConfig.servePath+"/console/export/sql"}})},exportJSON:function(){$("#tipMsg").text(""),$.ajax({url:latkeConfig.servePath+"/console/export/json",type:"GET",cache:!1,success:function(e,t){e.sc?$("#tipMsg").text(e.msg):window.location=latkeConfig.servePath+"/console/export/json"}})},exportHexo:function(){$("#tipMsg").text(""),$.ajax({url:latkeConfig.servePath+"/console/export/hexo",type:"GET",cache:!1,success:function(e,t){e.sc?$("#tipMsg").text(e.msg):window.location=latkeConfig.servePath+"/console/export/hexo"}})},getUnusedTags:function(){$.ajax({url:latkeConfig.servePath+"/console/tag/unused",type:"GET",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");e.unusedTags.length}})},update:function(){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var e={replyNotificationTemplate:{subject:$("#replayEmailTemplateTitle").val(),body:$("#replayEmailTemplateBody").val()}};$.ajax({url:latkeConfig.servePath+"/console/reply/notification/template",type:"PUT",cache:!1,data:JSON.stringify(e),success:function(e,t){$("#tipMsg").text(e.msg),$("#loadMsg").text("")}})}},admin.register.others={obj:admin.others,init:admin.others.init,refresh:function(){admin.clearTip()}},admin.linkList={tablePagination:new TablePaginate("link"),pageInfo:{currentCount:1,pageCount:1,currentPage:1},id:"",init:function(e){this.tablePagination.buildTable([{text:"",index:"linkOrder",width:60},{style:"padding-left: 12px;",text:Label.linkTitleLabel,index:"linkTitle",width:230},{style:"padding-left: 12px;",text:Label.urlLabel,index:"linkAddress",minWidth:180},{style:"padding-left: 12px;",text:Label.linkDescriptionLabel,index:"linkDescription",width:360}]),this.tablePagination.initPagination(),this.getList(e),$("#updateLink").dialog({width:700,height:290,modal:!0,hideFooter:!0})},getList:function(e){$("#loadMsg").text(Label.loadingLabel),0===e&&(e=1),this.pageInfo.currentPage=e;var t=this;$.ajax({url:latkeConfig.servePath+"/console/links/"+e+"/"+Label.PAGE_SIZE+"/"+Label.WINDOW_SIZE,type:"GET",cache:!1,success:function(a,i){if($("#tipMsg").text(a.msg),!a.sc)return void $("#loadMsg").text("");var n=a.links,l=[];admin.linkList.pageInfo.currentCount=n.length,admin.linkList.pageInfo.pageCount=0===a.pagination.paginationPageCount?1:a.pagination.paginationPageCount;for(var o=0;o<n.length;o++)l[o]={},0===o?1===n.length?l[o].linkOrder="":l[o].linkOrder='<div class="table-center" style="width:14px">                                <span onclick="admin.linkList.changeOrder('+n[o].oId+", "+o+', \'down\');" class="icon-move-down"></span>                            </div>':o===n.length-1?l[o].linkOrder='<div class="table-center" style="width:14px">                                <span onclick="admin.linkList.changeOrder('+n[o].oId+", "+o+', \'up\');" class="icon-move-up"></span>                            </div>':l[o].linkOrder='<div class="table-center" style="width:38px">                                <span onclick="admin.linkList.changeOrder('+n[o].oId+", "+o+', \'up\');" class="icon-move-up"></span>                                <span onclick="admin.linkList.changeOrder('+n[o].oId+", "+o+', \'down\');" class="icon-move-down"></span>                            </div>',l[o].linkTitle=n[o].linkTitle,l[o].linkAddress="<a target='_blank' class='no-underline' href='"+n[o].linkAddress+"'>"+n[o].linkAddress+"</a>",l[o].linkDescription=n[o].linkDescription,l[o].expendRow="<span><a href='"+n[o].linkAddress+"' target='_blank'>"+Label.viewLabel+"</a>                                  <a href='javascript:void(0)' onclick=\"admin.linkList.get('"+n[o].oId+"')\">"+Label.updateLabel+"</a>                                <a href='javascript:void(0)' onclick=\"admin.linkList.del('"+n[o].oId+"', '"+n[o].linkTitle+"')\">"+Label.removeLabel+"</a></span>";t.tablePagination.updateTablePagination(l,e,a.pagination),$("#loadMsg").text("")}})},add:function(){if(this.validate()){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var e={link:{linkTitle:$("#linkTitle").val(),linkAddress:$("#linkAddress").val(),linkDescription:$("#linkDescription").val()}};$.ajax({url:latkeConfig.servePath+"/console/link/",type:"POST",cache:!1,data:JSON.stringify(e),success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");$("#linkTitle").val(""),$("#linkAddress").val(""),$("#linkDescription").val(""),admin.linkList.pageInfo.currentCount===Label.PAGE_SIZE&&admin.linkList.pageInfo.currentPage===admin.linkList.pageInfo.pageCount&&admin.linkList.pageInfo.pageCount++;var a=window.location.hash.split("/");admin.linkList.pageInfo.pageCount!==parseInt(a[a.length-1])&&admin.setHashByPage(admin.linkList.pageInfo.pageCount),admin.linkList.getList(admin.linkList.pageInfo.pageCount),$("#loadMsg").text("")}})}},get:function(e){$("#loadMsg").text(Label.loadingLabel),$("#updateLink").dialog("open"),$.ajax({url:latkeConfig.servePath+"/console/link/"+e,type:"GET",cache:!1,success:function(t,a){if($("#tipMsg").text(t.msg),!t.sc)return void $("#loadMsg").text("");admin.linkList.id=e,$("#linkTitleUpdate").val(t.link.linkTitle),$("#linkAddressUpdate").val(t.link.linkAddress),$("#linkDescriptionUpdate").val(t.link.linkDescription),$("#loadMsg").text("")}})},update:function(){if(this.validate("Update")){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var e={link:{linkTitle:$("#linkTitleUpdate").val(),oId:this.id,linkAddress:$("#linkAddressUpdate").val(),linkDescription:$("#linkDescriptionUpdate").val()}};$.ajax({url:latkeConfig.servePath+"/console/link/",type:"PUT",cache:!1,data:JSON.stringify(e),success:function(e,t){if($("#updateLink").dialog("close"),$("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");admin.linkList.getList(admin.linkList.pageInfo.currentPage),$("#loadMsg").text("")}})}},del:function(e,t){confirm(Label.confirmRemoveLabel+Label.permalinkLabel+'"'+t+'"?')&&($("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),$.ajax({url:latkeConfig.servePath+"/console/link/"+e,type:"DELETE",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");var a=admin.linkList.pageInfo.currentPage;1===admin.linkList.pageInfo.currentCount&&1!==admin.linkList.pageInfo.pageCount&&admin.linkList.pageInfo.currentPage===admin.linkList.pageInfo.pageCount&&(admin.linkList.pageInfo.pageCount--,a=admin.linkList.pageInfo.pageCount);var i=window.location.hash.split("/");a!==parseInt(i[i.length-1])&&admin.setHashByPage(a),admin.linkList.getList(a),$("#loadMsg").text("")}}))},validate:function(e){if(e||(e=""),""===$("#linkTitle"+e).val().replace(/\s/g,""))$("#tipMsg").text(Label.titleEmptyLabel),$("#linkTitle"+e).focus().val("");else if(""===$("#linkAddress"+e).val().replace(/\s/g,""))$("#tipMsg").text(Label.addressEmptyLabel),$("#linkAddress"+e).focus().val("");else{if(/^\w+:\/\//.test($("#linkAddress"+e).val()))return!0;$("#tipMsg").text(Label.addressInvalidLabel),$("#linkAddress"+e).focus().val("")}return!1},changeOrder:function(e,t,a){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var i={oId:e.toString(),direction:a};$.ajax({url:latkeConfig.servePath+"/console/link/order/",type:"PUT",cache:!1,data:JSON.stringify(i),success:function(e,t){$("#tipMsg").text(e.msg),admin.linkList.getList(admin.linkList.pageInfo.currentPage),$("#loadMsg").text("")}})}},admin.register["link-list"]={obj:admin.linkList,init:admin.linkList.init,refresh:admin.linkList.getList},admin.preference={locale:"",editorType:"",init:function(){$("#tabPreference").tabs(),$.ajax({url:latkeConfig.servePath+"/console/preference/",type:"GET",cache:!1,success:function(result,textStatus){if($("#tipMsg").text(result.msg),!result.sc)return void $("#loadMsg").text("");var preference=result.preference;$("#metaKeywords").val(preference.metaKeywords),$("#metaDescription").val(preference.metaDescription),$("#blogTitle").val(preference.blogTitle),$("#blogSubtitle").val(preference.blogSubtitle),$("#mostCommentArticleDisplayCount").val(preference.mostCommentArticleDisplayCount),$("#mostViewArticleDisplayCount").val(preference.mostViewArticleDisplayCount),$("#recentCommentDisplayCount").val(preference.recentCommentDisplayCount),$("#mostUsedTagDisplayCount").val(preference.mostUsedTagDisplayCount),$("#articleListDisplayCount").val(preference.articleListDisplayCount),$("#articleListPaginationWindowSize").val(preference.articleListPaginationWindowSize),$("#localeString").val(preference.localeString),$("#timeZoneId").val(preference.timeZoneId),$("#noticeBoard").val(preference.noticeBoard),$("#footerContent").val(preference.footerContent),$("#htmlHead").val(preference.htmlHead),$("#externalRelevantArticlesDisplayCount").val(preference.externalRelevantArticlesDisplayCount),$("#relevantArticlesDisplayCount").val(preference.relevantArticlesDisplayCount),$("#randomArticlesDisplayCount").val(preference.randomArticlesDisplayCount),$("#keyOfSolo").val(preference.keyOfSolo),"true"===preference.enableArticleUpdateHint?$("#enableArticleUpdateHint").attr("checked","checked"):$("#enableArticleUpdateHint").removeAttr("checked"),"true"===preference.allowVisitDraftViaPermalink?$("#allowVisitDraftViaPermalink").attr("checked","checked"):$("allowVisitDraftViaPermalink").removeAttr("checked"),"true"===preference.allowRegister?$("#allowRegister").attr("checked","checked"):$("#allowRegister").removeAttr("checked"),"true"===preference.commentable?$("#commentable").attr("checked","checked"):$("commentable").removeAttr("checked"),admin.preference.locale=preference.localeString,admin.preference.editorType=preference.editorType,$("#skinMain").data("skinDirName",preference.skinDirName);for(var skins=eval("("+preference.skins+")"),skinsHTML="",i=0;i<skins.length;i++){var selectedClass="";skins[i].skinName===preference.skinName&&skins[i].skinDirName===preference.skinDirName&&(selectedClass+=" selected"),skinsHTML+="<div title='"+skins[i].skinDirName+"' class='left skinItem"+selectedClass+"'><img class='skinPreview' src='"+latkeConfig.staticServePath+"/skins/"+skins[i].skinDirName+"/preview.png'/><div>"+skins[i].skinName+"</div></div>"}$("#skinMain").append(skinsHTML+"<div class='clear'></div>"),$(".skinItem").click(function(){$(".skinItem").removeClass("selected"),$(this).addClass("selected"),$("#skinMain").data("skinDirName",this.title)});for(var signs=eval("("+preference.signs+")"),j=1;j<signs.length;j++)$("#preferenceSign"+j).val(signs[j].signHTML);$("#articleListDisplay").val(preference.articleListStyle),$("#editorType").val(preference.editorType),$("#feedOutputMode").val(preference.feedOutputMode),$("#feedOutputCnt").val(preference.feedOutputCnt),$("#loadMsg").text("")}}),$.ajax({url:latkeConfig.servePath+"/console/preference/qiniu",type:"GET",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");$("#qiniuAccessKey").val(e.qiniu.qiniuAccessKey),$("#qiniuSecretKey").val(e.qiniu.qiniuSecretKey),$("#qiniuDomain").val(e.qiniu.qiniuDomain),$("#qiniuBucket").val(e.qiniu.qiniuBucket)}})},validate:function(){return/^\d+$/.test($("#mostUsedTagDisplayCount").val())?/^\d+$/.test($("#recentCommentDisplayCount").val())?/^\d+$/.test($("#mostCommentArticleDisplayCount").val())?/^\d+$/.test($("#mostViewArticleDisplayCount").val())?/^\d+$/.test($("#articleListDisplayCount").val())?/^\d+$/.test($("#articleListPaginationWindowSize").val())?/^\d+$/.test($("#randomArticlesDisplayCount").val())?/^\d+$/.test($("#relevantArticlesDisplayCount").val())?!!/^\d+$/.test($("#externalRelevantArticlesDisplayCount").val())||($("#tipMsg").text("["+Label.paramSettingsLabel+" - "+Label.externalRelevantArticlesDisplayCntLabel+"] "+Label.nonNegativeIntegerOnlyLabel),$("#externalRelevantArticlesDisplayCount").focus(),!1):($("#tipMsg").text("["+Label.paramSettingsLabel+" - "+Label.relevantArticlesDisplayCntLabel+"] "+Label.nonNegativeIntegerOnlyLabel),$("#relevantArticlesDisplayCount").focus(),!1):($("#tipMsg").text("["+Label.paramSettingsLabel+" - "+Label.randomArticlesDisplayCntLabel+"] "+Label.nonNegativeIntegerOnlyLabel),$("#randomArticlesDisplayCount").focus(),!1):($("#tipMsg").text("["+Label.paramSettingsLabel+" - "+Label.windowSizeLabel+"] "+Label.nonNegativeIntegerOnlyLabel),$("#articleListPaginationWindowSize").focus(),!1):($("#tipMsg").text("["+Label.paramSettingsLabel+" - "+Label.pageSizeLabel+"] "+Label.nonNegativeIntegerOnlyLabel),$("#articleListDisplayCount").focus(),!1):($("#tipMsg").text("["+Label.paramSettingsLabel+" - "+Label.indexMostViewArticleDisplayCntLabel+"] "+Label.nonNegativeIntegerOnlyLabel),$("#mostViewArticleDisplayCount").focus(),!1):($("#tipMsg").text("["+Label.paramSettingsLabel+" - "+Label.indexMostCommentArticleDisplayCntLabel+"] "+Label.nonNegativeIntegerOnlyLabel),$("#mostCommentArticleDisplayCount").focus(),!1):($("#tipMsg").text("["+Label.paramSettingsLabel+" - "+Label.indexRecentCommentDisplayCntLabel+"] "+Label.nonNegativeIntegerOnlyLabel),$("#recentCommentDisplayCount").focus(),!1):($("#tipMsg").text("["+Label.paramSettingsLabel+" - "+Label.indexTagDisplayCntLabel+"] "+Label.nonNegativeIntegerOnlyLabel),$("#mostUsedTagDisplayCount").focus(),!1)},update:function(){if(admin.preference.validate()){$("#tipMsg").text(""),$("#loadMsg").text(Label.loadingLabel);var e=[{oId:0,signHTML:""},{oId:1,signHTML:$("#preferenceSign1").val()},{oId:2,signHTML:$("#preferenceSign2").val()},{oId:3,signHTML:$("#preferenceSign3").val()}],t={preference:{metaKeywords:$("#metaKeywords").val(),metaDescription:$("#metaDescription").val(),blogTitle:$("#blogTitle").val(),blogSubtitle:$("#blogSubtitle").val(),mostCommentArticleDisplayCount:$("#mostCommentArticleDisplayCount").val(),mostViewArticleDisplayCount:$("#mostViewArticleDisplayCount").val(),recentCommentDisplayCount:$("#recentCommentDisplayCount").val(),mostUsedTagDisplayCount:$("#mostUsedTagDisplayCount").val(),articleListDisplayCount:$("#articleListDisplayCount").val(),articleListPaginationWindowSize:$("#articleListPaginationWindowSize").val(),skinDirName:$("#skinMain").data("skinDirName"),localeString:$("#localeString").val(),timeZoneId:$("#timeZoneId").val(),noticeBoard:$("#noticeBoard").val(),footerContent:$("#footerContent").val(),htmlHead:$("#htmlHead").val(),externalRelevantArticlesDisplayCount:$("#externalRelevantArticlesDisplayCount").val(),relevantArticlesDisplayCount:$("#relevantArticlesDisplayCount").val(),randomArticlesDisplayCount:$("#randomArticlesDisplayCount").val(),enableArticleUpdateHint:$("#enableArticleUpdateHint").prop("checked"),signs:e,keyOfSolo:$("#keyOfSolo").val(),allowVisitDraftViaPermalink:$("#allowVisitDraftViaPermalink").prop("checked"),articleListStyle:$("#articleListDisplay").val(),editorType:$("#editorType").val(),feedOutputMode:$("#feedOutputMode").val(),feedOutputCnt:$("#feedOutputCnt").val(),commentable:$("#commentable").prop("checked"),
allowRegister:$("#allowRegister").prop("checked")}};$.ajax({url:latkeConfig.servePath+"/console/preference/",type:"PUT",cache:!1,data:JSON.stringify(t),success:function(t,a){if($("#tipMsg").text(t.msg),!t.sc)return void $("#loadMsg").text("");$("#localeString").val()===admin.preference.locale&&$("#editorType").val()===admin.preference.editorType||window.location.reload();for(var i=1;i<e.length;i++)1===$("#articleSign"+e[i].oId).length&&$("#articleSign"+e[i].oId).tip("option","content",""===e[i].signHTML?Label.signIsNullLabel:e[i].signHTML.replace(/\n/g,"").replace(/<script.*<\/script>/gi,""));$("#loadMsg").text("")}})}},updateQiniu:function(){$("#tipMsg").text(""),$("#loadMsg").text(Label.loadingLabel);var e={qiniuAccessKey:$("#qiniuAccessKey").val(),qiniuSecretKey:$("#qiniuSecretKey").val(),qiniuDomain:$("#qiniuDomain").val(),qiniuBucket:$("#qiniuBucket").val()};$.ajax({url:latkeConfig.servePath+"/console/preference/qiniu",type:"PUT",cache:!1,data:JSON.stringify(e),success:function(e,t){e.sc&&window.location.reload(),$("#tipMsg").text(e.msg),$("#loadMsg").text("")}})}},admin.register.preference={obj:admin.preference,init:admin.preference.init,refresh:function(){admin.clearTip()}},admin.pluginList={tablePagination:new TablePaginate("plugin"),pageInfo:{currentCount:1,pageCount:1,currentPage:1},init:function(e){this.tablePagination.buildTable([{style:"padding-left: 12px;",text:Label.pluginNameLabel,index:"name",width:230},{style:"padding-left: 12px;",text:Label.statusLabel,index:"status",minWidth:80},{style:"padding-left: 12px;",text:Label.authorLabel,index:"author",width:200},{style:"padding-left: 12px;",text:Label.versionLabel,index:"version",width:120}]),this.tablePagination.initPagination(),$("#pluginSetting").dialog({width:700,height:180,modal:!0,hideFooter:!0}),this.getList(e)},getList:function(e){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var t=this;$.ajax({url:latkeConfig.servePath+"/console/plugins/"+e+"/"+Label.PAGE_SIZE+"/"+Label.WINDOW_SIZE,type:"GET",cache:!1,success:function(a,i){if($("#tipMsg").text(a.msg),!a.sc)return void $("#loadMsg").text("");admin.pluginList.pageInfo.currentPage=e;for(var n=a.plugins,l=0;l<n.length;l++)n[l].expendRow="<a href='javascript:void(0)' onclick=\"admin.pluginList.changeStatus('"+n[l].oId+"', '"+n[l].status+"')\">","ENABLED"===n[l].status?(n[l].status=Label.enabledLabel,n[l].expendRow+=Label.disableLabel):(n[l].status=Label.disabledLabel,n[l].expendRow+=Label.enableLabel),n[l].expendRow+="</a>  ","{}"!=n[l].setting&&(n[l].expendRow+="<a href='javascript:void(0)' onclick=\"admin.pluginList.toSetting('"+n[l].oId+"')\"> "+Label.settingLabel+" </a>  ");t.tablePagination.updateTablePagination(a.plugins,e,a.pagination),$("#loadMsg").text("")}})},toSetting:function(e){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var t={oId:e};$.ajax({url:latkeConfig.servePath+"/console/plugin/toSetting",type:"POST",cache:!1,data:JSON.stringify(t),success:function(e,t){$("#tipMsg").text(e.msg),$("#pluginSetting").html(e),$("#pluginSetting").dialog("open"),$("#loadMsg").text("")}})},changeStatus:function(e,t){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),t="ENABLED"===t?"DISABLED":"ENABLED";var a={oId:e,status:t};$.ajax({url:latkeConfig.servePath+"/console/plugin/status/",type:"PUT",cache:!1,data:JSON.stringify(a),success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");$("#loadMsg").text(""),window.location.reload()}})}},admin.register["plugin-list"]={obj:admin.pluginList,init:admin.pluginList.init,refresh:function(){$("#loadMsg").text("")}},admin.userList={tablePagination:new TablePaginate("user"),pageInfo:{currentCount:1,pageCount:1,currentPage:1},userInfo:{oId:"",userRole:""},init:function(e){this.tablePagination.buildTable([{style:"padding-left: 12px;",text:Label.commentNameLabel,index:"userName",width:230},{style:"padding-left: 12px;",text:Label.commentEmailLabel,index:"userEmail",minWidth:180},{style:"padding-left: 12px;",text:Label.roleLabel,index:"isAdmin",width:120}]),this.tablePagination.initPagination(),this.getList(e),$("#userUpdate").dialog({width:700,height:360,modal:!0,hideFooter:!0})},getList:function(e){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),this.pageInfo.currentPage=e;var t=this;$.ajax({url:latkeConfig.servePath+"/console/users/"+e+"/"+Label.PAGE_SIZE+"/"+Label.WINDOW_SIZE,type:"GET",cache:!1,success:function(a,i){if($("#tipMsg").text(a.msg),!a.sc)return void $("#loadMsg").text("");var n=a.users,l=[];if(admin.userList.pageInfo.currentCount=n.length,admin.userList.pageInfo.pageCount=a.pagination.paginationPageCount,n.length<1)return $("#tipMsg").text("No user  "+Label.reportIssueLabel),void $("#loadMsg").text("");for(var o=0;o<n.length;o++)l[o]={},l[o].userName=n[o].userName,l[o].userEmail=n[o].userEmail,"adminRole"===n[o].userRole?(l[o].isAdmin="&nbsp;"+Label.administratorLabel,l[o].expendRow="<a href='javascript:void(0)' onclick=\"admin.userList.get('"+n[o].oId+"', '"+n[o].userRole+"')\">"+Label.updateLabel+"</a>"):(l[o].expendRow="<a href='javascript:void(0)' onclick=\"admin.userList.get('"+n[o].oId+"', '"+n[o].userRole+"')\">"+Label.updateLabel+"</a>                                <a href='javascript:void(0)' onclick=\"admin.userList.del('"+n[o].oId+"', '"+n[o].userName+"')\">"+Label.removeLabel+"</a> <a href='javascript:void(0)' onclick=\"admin.userList.changeRole('"+n[o].oId+"')\">"+Label.changeRoleLabel+"</a>","defaultRole"===n[o].userRole?l[o].isAdmin=Label.commonUserLabel:l[o].isAdmin=Label.visitorUserLabel),t.tablePagination.updateTablePagination(l,e,a.pagination),$("#loadMsg").text("")}})},add:function(){if(this.validate()){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var e={userName:$("#userName").val(),userEmail:$("#userEmail").val(),userURL:$("#userURL").val(),userPassword:$("#userPassword").val(),userAvatar:$("#userAvatar").val()};$.ajax({url:latkeConfig.servePath+"/console/user/",type:"POST",cache:!1,data:JSON.stringify(e),success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");$("#userName").val(""),$("#userEmail").val(""),$("#userURL").val(""),$("#userPassword").val(""),$("#userAvatar").val(""),admin.userList.pageInfo.currentCount===Label.PAGE_SIZE&&admin.userList.pageInfo.currentPage===admin.userList.pageInfo.pageCount&&admin.userList.pageInfo.pageCount++;var a=window.location.hash.split("/");admin.userList.pageInfo.pageCount!==parseInt(a[a.length-1])&&admin.setHashByPage(admin.userList.pageInfo.pageCount),admin.userList.getList(admin.userList.pageInfo.pageCount),$("#loadMsg").text("")}})}},get:function(e,t){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),$("#userUpdate").dialog("open"),$.ajax({url:latkeConfig.servePath+"/console/user/"+e,type:"GET",cache:!1,success:function(a,i){if($("#tipMsg").text(a.msg),!a.sc)return void $("#loadMsg").text("");var n=$("#userEmailUpdate");$("#userNameUpdate").val(a.user.userName).data("userInfo",{oId:e,userRole:t}),n.val(a.user.userEmail),"adminRole"===t?n.attr("disabled","disabled"):n.removeAttr("disabled"),$("#userURLUpdate").val(a.user.userURL),$("#userPasswordUpdate").val(a.user.userPassword),$("#userAvatarUpdate").val(a.user.userAvatar),$("#loadMsg").text("")}})},update:function(){if(this.validate("Update")){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var e=$("#userNameUpdate").data("userInfo"),t={userName:$("#userNameUpdate").val(),oId:e.oId,userEmail:$("#userEmailUpdate").val(),userURL:$("#userURLUpdate").val(),userRole:e.userRole,userPassword:$("#userPasswordUpdate").val(),userAvatar:$("#userAvatarUpdate").val()};$.ajax({url:latkeConfig.servePath+"/console/user/",type:"PUT",cache:!1,data:JSON.stringify(t),success:function(e,t){if($("#userUpdate").dialog("close"),$("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");admin.userList.getList(admin.userList.pageInfo.currentPage),$("#loadMsg").text("")}})}},del:function(e,t){confirm(Label.confirmRemoveLabel+Label.userLabel+'"'+t+'"?')&&($("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),$.ajax({url:latkeConfig.servePath+"/console/user/"+e,type:"DELETE",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");var a=admin.userList.pageInfo.currentPage;1===admin.userList.pageInfo.currentCount&&1!==admin.userList.pageInfo.pageCount&&admin.userList.pageInfo.currentPage===admin.userList.pageInfo.pageCount&&(admin.userList.pageInfo.pageCount--,a=admin.userList.pageInfo.pageCount);var i=window.location.hash.split("/");a!==parseInt(i[i.length-1])&&admin.setHashByPage(a),admin.userList.getList(a),$("#loadMsg").text("")}}))},changeRole:function(e){$("#tipMsg").text(""),$.ajax({url:latkeConfig.servePath+"/console/changeRole/"+e,type:"GET",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");var a=admin.userList.pageInfo.currentPage;1===admin.userList.pageInfo.currentCount&&1!==admin.userList.pageInfo.pageCount&&admin.userList.pageInfo.currentPage===admin.userList.pageInfo.pageCount&&(admin.userList.pageInfo.pageCount--,a=admin.userList.pageInfo.pageCount);var i=window.location.hash.split("/");a!==parseInt(i[i.length-1])&&admin.setHashByPage(a),admin.userList.getList(a),$("#loadMsg").text("")}})},validate:function(e){e||(e="");var t=$("#userName"+e).val().replace(/(^\s*)|(\s*$)/g,"");if(2>t.length||t.length>20)$("#tipMsg").text(Label.nameTooLongLabel),$("#userName"+e).focus();else if(""===$("#userEmail"+e).val().replace(/\s/g,""))$("#tipMsg").text(Label.mailCannotEmptyLabel),$("#userEmail"+e).focus();else if(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test($("#userEmail"+e).val())){if(""!==$("#userPassword"+e).val())return!0;$("#tipMsg").text(Label.passwordEmptyLabel),$("#userPassword"+e).focus()}else $("#tipMsg").text(Label.mailInvalidLabel),$("#userEmail"+e).focus();return!1}},admin.register["user-list"]={obj:admin.userList,init:admin.userList.init,refresh:admin.userList.getList},admin.categoryList={tablePagination:new TablePaginate("category"),pageInfo:{currentCount:1,pageCount:1,currentPage:1},init:function(e){this.tablePagination.buildTable([{text:"",index:"linkOrder",width:60},{style:"padding-left: 12px;",text:Label.titleLabel,index:"categoryTitle",width:230},{style:"padding-left: 12px;",text:"URI",index:"categoryURI",width:230},{style:"padding-left: 12px;",text:Label.descriptionLabel,index:"categoryDesc",minWidth:180}]),this.tablePagination.initPagination(),this.getList(e),$("#categoryUpdate").dialog({width:700,height:358,modal:!0,hideFooter:!0}),$.ajax({url:latkeConfig.servePath+"/console/tags",type:"GET",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");if(!(0>=e.tags.length)){for(var a=[],i=0;i<e.tags.length;i++)a.push(e.tags[i].tagTitle);$("#categoryTags").completed({height:160,buttonText:Label.selectLabel,data:a}),$("#loadMsg").text("")}}})},getList:function(e){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),this.pageInfo.currentPage=e;var t=this;$.ajax({url:latkeConfig.servePath+"/console/categories/"+e+"/"+Label.PAGE_SIZE+"/"+Label.WINDOW_SIZE,type:"GET",cache:!1,success:function(a,i){if($("#tipMsg").text(a.msg),!a.sc)return void $("#loadMsg").text("");var n=a.categories,l=[];admin.categoryList.pageInfo.currentCount=n.length,admin.categoryList.pageInfo.pageCount=0===a.pagination.paginationPageCount?1:a.pagination.paginationPageCount;for(var o=0;o<n.length;o++)l[o]={},0===o?1===n.length?l[o].linkOrder="":l[o].linkOrder='<div class="table-center" style="width:14px">                                <span onclick="admin.categoryList.changeOrder('+n[o].oId+", "+o+', \'down\');" class="icon-move-down"></span>                            </div>':o===n.length-1?l[o].linkOrder='<div class="table-center" style="width:14px">                                <span onclick="admin.categoryList.changeOrder('+n[o].oId+", "+o+', \'up\');" class="icon-move-up"></span>                            </div>':l[o].linkOrder='<div class="table-center" style="width:38px">                                <span onclick="admin.categoryList.changeOrder('+n[o].oId+", "+o+', \'up\');" class="icon-move-up"></span>                                <span onclick="admin.categoryList.changeOrder('+n[o].oId+", "+o+', \'down\');" class="icon-move-down"></span>                            </div>',l[o].categoryTitle=n[o].categoryTitle,l[o].categoryURI=n[o].categoryURI,l[o].categoryDesc=n[o].categoryDescription,l[o].expendRow="<a href='javascript:void(0)' onclick=\"admin.categoryList.get('"+n[o].oId+"')\">"+Label.updateLabel+"</a>                            <a href='javascript:void(0)' onclick=\"admin.categoryList.del('"+n[o].oId+"', '"+n[o].categoryTitle+"')\">"+Label.removeLabel+"</a> ";t.tablePagination.updateTablePagination(l,e,a.pagination),$("#loadMsg").text("")}})},add:function(){if(this.validate()){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var e={categoryTitle:$("#categoryName").val(),categoryTags:$("#categoryTags").val(),categoryURI:$("#categoryURI").val(),categoryDescription:$("#categoryDesc").val()};$.ajax({url:latkeConfig.servePath+"/console/category/",type:"POST",cache:!1,data:JSON.stringify(e),success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");$("#categoryName").val(""),$("#categoryTags").val(""),$("#categoryURI").val(""),$("#categoryDesc").val(""),admin.categoryList.pageInfo.currentCount===Label.PAGE_SIZE&&admin.categoryList.pageInfo.currentPage===admin.categoryList.pageInfo.pageCount&&admin.categoryList.pageInfo.pageCount++;var a=window.location.hash.split("/");admin.categoryList.pageInfo.pageCount!==parseInt(a[a.length-1])&&admin.setHashByPage(admin.categoryList.pageInfo.pageCount),admin.categoryList.getList(admin.categoryList.pageInfo.pageCount),$("#loadMsg").text("")}})}},get:function(e){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),$("#categoryUpdate").dialog("open"),$.ajax({url:latkeConfig.servePath+"/console/category/"+e,type:"GET",cache:!1,success:function(t,a){if($("#tipMsg").text(t.msg),!t.sc)return void $("#loadMsg").text("");$("#categoryNameUpdate").val(t.categoryTitle).data("oId",e),$("#categoryURIUpdate").val(t.categoryURI),$("#categoryDescUpdate").val(t.categoryDescription),$("#categoryTagsUpdate").val(t.categoryTags),$("#loadMsg").text("")}})},update:function(){if(this.validate("Update")){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var e={categoryTitle:$("#categoryNameUpdate").val(),oId:$("#categoryNameUpdate").data("oId"),categoryTags:$("#categoryTagsUpdate").val(),categoryURI:$("#categoryURIUpdate").val(),categoryDescription:$("#categoryDescUpdate").val()};$.ajax({url:latkeConfig.servePath+"/console/category/",type:"PUT",cache:!1,data:JSON.stringify(e),success:function(e,t){if($("#categoryUpdate").dialog("close"),$("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");admin.categoryList.getList(admin.categoryList.pageInfo.currentPage),$("#loadMsg").text("")}})}},del:function(e,t){confirm(Label.confirmRemoveLabel+Label.categoryLabel+'"'+t+'"?')&&($("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text(""),$.ajax({url:latkeConfig.servePath+"/console/category/"+e,type:"DELETE",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");var a=admin.categoryList.pageInfo.currentPage;1===admin.categoryList.pageInfo.currentCount&&1!==admin.categoryList.pageInfo.pageCount&&admin.categoryList.pageInfo.currentPage===admin.categoryList.pageInfo.pageCount&&(admin.categoryList.pageInfo.pageCount--,a=admin.categoryList.pageInfo.pageCount);var i=window.location.hash.split("/");a!==parseInt(i[i.length-1])&&admin.setHashByPage(a),admin.categoryList.getList(a),$("#loadMsg").text("")}}))},validate:function(e){e||(e="");var t=$("#categoryName"+e).val().replace(/(^\s*)|(\s*$)/g,"");if(2>t.length||t.length>32)$("#tipMsg").text(Label.categoryTooLongLabel),$("#categoryName"+e).focus();else{if(""!==$.trim($("#categoryTags"+e).val()))return!0;$("#tipMsg").text(Label.tagsEmptyLabel),$("#categoryTags"+e).focus()}return!1},changeOrder:function(e,t,a){$("#loadMsg").text(Label.loadingLabel),$("#tipMsg").text("");var i={oId:e.toString(),direction:a};$.ajax({url:latkeConfig.servePath+"/console/category/order/",type:"PUT",cache:!1,data:JSON.stringify(i),success:function(e,t){$("#tipMsg").text(e.msg),admin.categoryList.getList(admin.categoryList.pageInfo.currentPage),$("#loadMsg").text("")}})}},admin.register["category-list"]={obj:admin.categoryList,init:admin.categoryList.init,refresh:admin.categoryList.getList},admin.commentList={tablePagination:new TablePaginate("comment"),pageInfo:{currentPage:1},init:function(e){this.tablePagination.buildTable([{text:Label.commentContentLabel,index:"content",minWidth:174,style:"padding-left: 12px;"},{text:Label.authorLabel,index:"title",style:"padding-left: 12px;"},{text:Label.dateLabel,index:"date",width:60,style:"padding-left: 12px;"}]),this.tablePagination.initPagination(),this.getList(e)},getList:function(e){var t=this;$("#loadMsg").text(Label.loadingLabel),$.ajax({url:latkeConfig.servePath+"/console/comments/"+e+"/"+Label.PAGE_SIZE+"/"+Label.WINDOW_SIZE,type:"GET",cache:!1,success:function(a,i){if($("#tipMsg").text(a.msg),!a.sc)return void $("#loadMsg").text("");t.pageInfo.currentPage=e;for(var n=a.comments,l=[],o=0;o<n.length;o++){var s="Article";"pageComment"===n[o].type&&(s="Page"),l[o]={},l[o].content='<div class="content-reset">'+Util.replaceEmString(n[o].commentContent)+"</div><span class='table-tag'> on &nbsp;&nbsp;</span><a href='"+latkeConfig.servePath+n[o].commentSharpURL+"' target='_blank'>"+n[o].commentTitle+"</a>",l[o].expendRow="<a href='javascript:void(0)' onclick=\"admin.commentList.del('"+n[o].oId+"', '"+s+"')\">"+Label.removeLabel+"</a>",l[o].title="<img class='small-head' src='"+n[o].commentThumbnailURL+"'/>","http://"===n[o].commentURL?l[o].title+=n[o].commentName:l[o].title+="<a href='"+n[o].commentURL+"' target='_blank' class='no-underline'>"+n[o].commentName+"</a>",l[o].title+="<br/><a href='mailto:"+n[o].commentEmail+"'>"+n[o].commentEmail+"</a>",l[o].date=$.bowknot.getDate(n[o].commentTime)}t.tablePagination.updateTablePagination(l,e,a.pagination),$("#loadMsg").text("")}})},del:function(e,t){confirm(Label.confirmRemoveLabel+Label.commentLabel+"?")&&($("#loadMsg").text(Label.loadingLabel),$.ajax({url:latkeConfig.servePath+"/console/"+t.toLowerCase()+"/comment/"+e,type:"DELETE",cache:!1,success:function(e,t){if($("#tipMsg").text(e.msg),!e.sc)return void $("#loadMsg").text("");admin.commentList.getList(admin.commentList.pageInfo.currentPage),$("#loadMsg").text("")}}))}},admin.register["comment-list"]={obj:admin.commentList,init:admin.commentList.init,refresh:admin.commentList.getList};var plugins={};admin.plugin={plugins:[],add:function(e){e.isInit=!1,e.hash=e.path.replace("/","#")+"/"+e.id,this.plugins.push(e);var t=this._analysePath(e.path);e.index&&t.length<2&&this._addNew(e,t)},setCurByHash:function(e){for(var t=this.plugins,a=0;a<t.length;a++){var i=t[a],n=this._analysePath(i.path),l=!1;i.index&&window.location.hash.indexOf(i.hash)>-1?l=!0:(i.path.replace("/","#")===window.location.hash||"#main"===window.location.hash&&i.path.indexOf("/main/panel")>-1)&&(l=!0),l&&(i.isInit?plugins[i.id].refresh&&plugins[i.id].refresh(e.page):(i.index?2===n.length&&this._addNew(i,n):this._addToExist(i,n),plugins[i.id].init(e.page),i.isInit=!0))}},_analysePath:function(e){var t=e.split("/");return t.splice(0,1),t},_addNew:function(e,t){if(2===t.length)return e.target=$("#tabPreference li").get(e.index-1),void $("#tabPreference").tabs("add",e);""===t[0]?e.target=$("#tabs>ul>li").get(e.index-1):"article"===t[0]?e.target=$("#tabArticleMgt>li").get(e.index-1):"tools"===t[0]&&(admin.tools.push("#"+e.id),e.target=$("#tabTools>li").get(e.index-1)),e.target||alert("data.index is error!"),$("#tabs").tabs("add",e)},_addToExist:function(e,t){switch(t[0]){case"main":$("#mainPanel"+t[1].charAt(5)).append(e.content);break;case"tools":case"article":2===t.length?$("#tabsPanel_"+t[1]).append(e.content):$("#tabPreferencePanel_"+t[2]).append(e.content);break;case"comment-list":$("#tabsPanel_comment-list").append(e.content)}}},admin.main={},admin.register.main={obj:admin.main,init:function(){admin.clearTip()},refresh:function(){admin.clearTip()}},admin.about={init:function(){$.ajax({url:"https://rhythm.b3log.org/version/solo/latest/"+Label.version,type:"GET",cache:!1,dataType:"jsonp",success:function(e,t){var a=e.soloVersion;a===Label.version?$("#aboutLatest").text(Label.upToDateLabel):$("#aboutLatest").html(Label.outOfDateLabel+"<a href='"+e.soloDownload+"'>"+a+"</a>")},complete:function(e,t){admin.clearTip()}})}},admin.register.about={obj:admin.about,init:admin.about.init,refresh:function(){admin.clearTip()}};