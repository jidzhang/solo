var Util={parseMarkdown:function(e){var t=!1,n=!1,i=!1,e=e||"article-body";if($("."+e).each(function(){$(this).find("p").each(function(){($(this).text().indexOf("$\\")>-1||$(this).text().indexOf("$$")>-1)&&(t=!0)}),$(this).find("code.lang-flow, code.language-flow").length>0&&(n=!0),$(this).find("code.lang-sequence, code.language-sequence").length>0&&(i=!0)}),t){var o=function(){MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,skipTags:["pre","code","script"]}}),MathJax.Hub.Typeset()};"undefined"!=typeof MathJax?o():$.ajax({method:"GET",url:"https://cdn.staticfile.org/MathJax/MathJax-2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&_=1473258780393",dataType:"script",cache:!0}).done(function(){o()})}if(n){var a=function(){$("."+e+" code.lang-flow, ."+e+" code.language-flow").each(function(e){var t=$(this),n="symFlow"+(new Date).getTime()+e;t.hide();var i=flowchart.parse($.trim(t.text()));t.parent().after('<div style="text-align: center" id="'+n+'"></div>'),i.drawSVG(n),t.parent().remove(),$("#"+n).find("svg").height("auto").width("auto")})};"undefined"!=typeof flowchart?a():$.ajax({method:"GET",url:latkeConfig.staticServePath+"/js/lib/flowchart/flowchart.min.js",dataType:"script",cache:!0}).done(function(){a()})}if(i){var r=function(){$("."+e+" code.lang-sequence, ."+e+" code.language-sequence").each(function(e){var t=$(this),n="symSequence"+(new Date).getTime()+e;t.hide();var i=Diagram.parse($.trim(t.text()));t.parent().after('<div style="text-align: center" id="'+n+'"></div>'),i.drawSVG(n,{theme:"simple"}),t.parent().remove(),$("#"+n).find("svg").height("auto").width("auto")})};"undefined"!=typeof Diagram?r():$.ajax({method:"GET",url:latkeConfig.staticServePath+"/js/lib/sequence/sequence-diagram-min.js",dataType:"script",cache:!0}).done(function(){r()}).error(function(){console.log("sequence load error!")})}},isLoggedIn:function(){return!!(1===$("#admin").length&&$("#admin").data("login")||"true"===latkeConfig.isLoggedIn)},getUserName:function(){return 1===$("#adminName").length?$("#adminName").text():latkeConfig.userName},error:function(){$("#tipMsg").text("Error: "+arguments[0]+" File: "+arguments[1]+"\nLine: "+arguments[2]+" please report this issue on https://github.com/b3log/solo/issues/new"),$("#loadMsg").text("")},killIE:function(){var e=function(){if(""===Cookie.readCookie("showKill")){var e=($(window).width()-701)/2,t=($(window).height()-420)/2;$("body").append("<div style='display: block; height: 100%; width: 100%; position: fixed; background-color: rgb(0, 0, 0); opacity: 0.6; top: 0px;z-index:11'></div><iframe style='left:"+e+"px;z-index:20;top: "+t+"px; position: fixed; border: 0px none; width: 701px; height: 420px;' src='"+latkeConfig.servePath+"/kill-browser'></iframe>")}};if($.browser.msie){if("6.0"===$.browser.version||"7.0"===$.browser.version)return void e();if(window.external&&window.external.twGetRunPath){var t=external.twGetRunPath();if(t&&t.toLowerCase().indexOf("360se")>-1&&window.location.href.indexOf("admin-index")>-1)return void e()}}},replaceEmString:function(e){var t=e.split("[em");if(1===t.length)return e;e=t[0];for(var n=1;n<t.length;n++){var i=t[n].substr(0,2);e+="<img width='20' src='"+latkeConfig.staticServePath+"/images/emotions/em"+i+".png' alt='"+Label["em"+i+"Label"]+"' title='"+Label["em"+i+"Label"]+"'/> "+t[n].substr(3)}return e},proessURL:function(e){return/^\w+:\/\//.test(e)||(e="http://"+e),e},switchMobile:function(e){Cookie.createCookie("btouch_switch_toggle",e,365),setTimeout(function(){location.reload()},1250)},setTopBar:function(){var e=$("#top");if(1===e.length){var t=$("#showTop");t.click(function(){e.slideDown(),t.hide()}),$("#hideTop").click(function(){e.slideUp(),t.show()})}},goTop:function(){$("html, body").animate({scrollTop:0},800)},goBottom:function(e){e||(e=0);var t=$("body").height()>$(document).height()?$("body").height():$(document).height();window.scrollTo(0,t-$(window).height()-e)},init:function(){Util.killIE(),Util.setTopBar(),Util.parseMarkdown()},replaceSideEm:function(e){for(var t=0;t<e.length;t++){var n=$(e[t]);n.html(Util.replaceEmString(n.html()))}},buildTags:function(e){e=e||"tags";for(var t=["tags1","tags2","tags3","tags4","tags5"],n=$("#"+e+" b").get(),i=parseInt($("#"+e+" b").last().text()),o=Math.ceil(i/t.length),a=0;a<n.length;a++)for(var r=parseInt(n[a].innerHTML),s=0;s<t.length;s++)if(r>s*o&&r<=(s+1)*o){n[a].parentNode.className=t[s];break}$("#"+e).html($("#"+e+" li").get().sort(function(e,t){var n=$(e).find("span").text().toLowerCase(),i=$(t).find("span").text().toLowerCase();return n.localeCompare(i)}))},toDate:function(e,t){var n=new Date(e),i={"M+":n.getMonth()+1,"d+":n.getDate(),"H+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));for(var o in i)new RegExp("("+o+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[o]:("00"+i[o]).substr((""+i[o]).length)));return t},getWinHeight:function(){return window.innerHeight?window.innerHeight:"CSS1Compat"===document.compatMode?window.document.documentElement.clientHeight:window.document.body.clientHeight},addslashes:function(e){return(e+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")}};if(!Cookie)var Cookie={readCookie:function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},eraseCookie:function(e){this.createCookie(e,"",-1)},createCookie:function(e,t,n){var i="";if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),i="; expires="+o.toGMTString()}document.cookie=e+"="+encodeURIComponent(t)+i+"; path=/"}};